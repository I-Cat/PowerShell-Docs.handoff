{"nodes":[{"pos":[12,43],"content":"Selecting Items from a List Box","needQuote":true,"nodes":[{"content":"Selecting Items from a List Box","pos":[0,31]}]},{"pos":[76,93],"content":"powershell,cmdlet","needQuote":true,"nodes":[{"content":"powershell,cmdlet","pos":[0,17]}]},{"content":"Selecting Items from a List Box","pos":[241,272]},{"content":"Use Windows PowerShell 3.0 and later releases to create a dialog box that lets users select items from a list box control.","pos":[273,395]},{"content":"Create a list box control, and select items from it","pos":[400,451]},{"content":"Copy and then paste the following into Windows PowerShell ISE, and then save it as a Windows PowerShell script (.ps1).","pos":[452,570]},{"content":"The script begins by loading two .NET Framework classes: <bpt id=\"p1\">**</bpt>System.Drawing<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>System.Windows.Forms<ept id=\"p2\">**</ept>.","pos":[2388,2493],"source":"The script begins by loading two .NET Framework classes: **System.Drawing** and **System.Windows.Forms**."},{"content":"You then start a new instance of the .NET Framework class <bpt id=\"p1\">**</bpt>System.Windows.Forms.Form<ept id=\"p1\">**</ept>; that provides a blank form or window to which you can start adding controls.","pos":[2494,2659],"source":" You then start a new instance of the .NET Framework class **System.Windows.Forms.Form**; that provides a blank form or window to which you can start adding controls."},{"content":"After you create an instance of the Form class, assign values to three properties of this class.","pos":[2752,2848]},{"content":"<bpt id=\"p1\">**</bpt>Text.<ept id=\"p1\">**</ept>","pos":[2854,2863],"source":"**Text.**"},{"content":"This becomes the title of the window.","pos":[2864,2901]},{"content":"<bpt id=\"p1\">**</bpt>Size.<ept id=\"p1\">**</ept>","pos":[2907,2916],"source":"**Size.**"},{"content":"This is the size of the form, in pixels.","pos":[2917,2957]},{"content":"The preceding script creates a form that’s 300 pixels wide by 200 pixels tall.","pos":[2958,3036]},{"content":"<bpt id=\"p1\">**</bpt>StartingPosition.<ept id=\"p1\">**</ept>","pos":[3042,3063],"source":"**StartingPosition.**"},{"content":"This optional property is set to <bpt id=\"p1\">**</bpt>CenterScreen<ept id=\"p1\">**</ept> in the preceding script.","pos":[3064,3138],"source":" This optional property is set to **CenterScreen** in the preceding script."},{"content":"If you don’t add this property, Windows selects a location when the form is opened.","pos":[3139,3222]},{"content":"By setting the <bpt id=\"p1\">**</bpt>StartingPosition<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>CenterScreen<ept id=\"p2\">**</ept>, you’re automatically displaying the form in the middle of the screen each time it loads.","pos":[3223,3368],"source":" By setting the **StartingPosition** to **CenterScreen**, you’re automatically displaying the form in the middle of the screen each time it loads."},{"content":"Next, create an <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button for your form.","pos":[3503,3547],"source":"Next, create an **OK** button for your form."},{"content":"Specify the size and behavior of the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.","pos":[3548,3599],"source":" Specify the size and behavior of the **OK** button."},{"content":"In this example, the button position is 120 pixels from the form’s top edge, and 75 pixels from the left edge.","pos":[3600,3710]},{"content":"The button height is 23 pixels, while the button length is 75 pixels.","pos":[3711,3780]},{"content":"The script uses predefined Windows Forms types to determine the button behaviors.","pos":[3781,3862]},{"content":"Similarly, you create a <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button.","pos":[4188,4230],"source":"Similarly, you create a **Cancel** button."},{"content":"The <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button is 120 pixels from the top, but 150 pixels from the left edge of the window.","pos":[4231,4329],"source":" The **Cancel** button is 120 pixels from the top, but 150 pixels from the left edge of the window."},{"content":"Next, provide label text on your window that describes the information you want users to provide.","pos":[4692,4789]},{"content":"In this case, you want users to select a computer.","pos":[4790,4840]},{"content":"Add the control (in this case, a list box) that lets users provide the information you’ve described in your label text.","pos":[5079,5198]},{"content":"There are many other controls you can apply besides list boxes; for more controls, see <bpt id=\"p1\">[</bpt>System.Windows.Forms Namespace<ept id=\"p1\">](http://msdn.microsoft.com/library/k50ex0x9(v=vs.110).aspx)</ept> on MSDN.","pos":[5199,5386],"source":" There are many other controls you can apply besides list boxes; for more controls, see [System.Windows.Forms Namespace](http://msdn.microsoft.com/library/k50ex0x9(v=vs.110).aspx) on MSDN."},{"content":"In the next section, you specify the values you want the list box to display to users.","pos":[5586,5672]},{"pos":[5676,6028],"content":"[!NOTE]\nThe list box created by this script allows only one selection. To create a list box control that allows multiple selections, specify a value for the **SelectionMode** property, similarly to the following:  `$listBox.SelectionMode = \"MultiExtended\"`. For more information, see [Multiple-selection List Boxes](Multiple-selection-List-Boxes.md).","leadings":["","> "],"nodes":[{"content":"The list box created by this script allows only one selection. To create a list box control that allows multiple selections, specify a value for the **SelectionMode** property, similarly to the following:  `$listBox.SelectionMode = \"MultiExtended\"`. For more information, see [Multiple-selection List Boxes](Multiple-selection-List-Boxes.md).","pos":[8,350],"nodes":[{"content":"The list box created by this script allows only one selection.","pos":[0,62]},{"content":"To create a list box control that allows multiple selections, specify a value for the <bpt id=\"p1\">**</bpt>SelectionMode<ept id=\"p1\">**</ept> property, similarly to the following:  <ph id=\"ph1\">`$listBox.SelectionMode = \"MultiExtended\"`</ph>.","pos":[63,249],"source":" To create a list box control that allows multiple selections, specify a value for the **SelectionMode** property, similarly to the following:  `$listBox.SelectionMode = \"MultiExtended\"`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Multiple-selection List Boxes<ept id=\"p1\">](Multiple-selection-List-Boxes.md)</ept>.","pos":[250,342],"source":" For more information, see [Multiple-selection List Boxes](Multiple-selection-List-Boxes.md)."}]}]},{"content":"Add the list box control to your form, and instruct Windows to open the form atop other windows and dialog boxes when it’s opened.","pos":[6319,6449]},{"content":"Add the following line of code to display the form in Windows.","pos":[6512,6574]},{"pos":[6614,6807],"content":"Finally, the code inside the <bpt id=\"p1\">**</bpt>If<ept id=\"p1\">**</ept> block instructs Windows what to do with the form after users select an option from the list box, and then click the <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> button or press the <bpt id=\"p3\">**</bpt>Enter<ept id=\"p3\">**</ept> key.","source":"Finally, the code inside the **If** block instructs Windows what to do with the form after users select an option from the list box, and then click the **OK** button or press the **Enter** key."},{"content":"See Also","pos":[6920,6928]},{"pos":[6929,7263],"content":"<bpt id=\"p1\">[</bpt>Hey Scripting Guy:  Why don’t these PowerShell GUI examples work?<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=506644)</ept><ph id=\"ph1\">\n</ph><bpt id=\"p2\">[</bpt>GitHub: Dave Wyatt's WinFormsExampleUpdates<ept id=\"p2\">](https://github.com/dlwyatt/WinFormsExampleUpdates)</ept><ph id=\"ph2\">\n</ph><bpt id=\"p3\">[</bpt>Windows PowerShell Tip of the Week:  Selecting Items from a List Box<ept id=\"p3\">](http://technet.microsoft.com/library/ff730949.aspx)</ept>","source":"[Hey Scripting Guy:  Why don’t these PowerShell GUI examples work?](http://go.microsoft.com/fwlink/?LinkId=506644)\n[GitHub: Dave Wyatt's WinFormsExampleUpdates](https://github.com/dlwyatt/WinFormsExampleUpdates)\n[Windows PowerShell Tip of the Week:  Selecting Items from a List Box](http://technet.microsoft.com/library/ff730949.aspx)"}],"content":"---\ntitle:  Selecting Items from a List Box\nms.date:  2016-05-11\nkeywords:  powershell,cmdlet\ndescription:  \nms.topic:  article\nauthor:  jpjofre\nmanager:  dongill\nms.prod:  powershell\nms.assetid:  327c7cc5-21d0-4ace-b151-aa1491d1d3c2\n---\n\n# Selecting Items from a List Box\nUse Windows PowerShell 3.0 and later releases to create a dialog box that lets users select items from a list box control.\n\n## Create a list box control, and select items from it\nCopy and then paste the following into Windows PowerShell ISE, and then save it as a Windows PowerShell script (.ps1).\n\n```\nAdd-Type -AssemblyName System.Windows.Forms\nAdd-Type -AssemblyName System.Drawing\n\n$form = New-Object System.Windows.Forms.Form \n$form.Text = \"Select a Computer\"\n$form.Size = New-Object System.Drawing.Size(300,200) \n$form.StartPosition = \"CenterScreen\"\n\n$OKButton = New-Object System.Windows.Forms.Button\n$OKButton.Location = New-Object System.Drawing.Point(75,120)\n$OKButton.Size = New-Object System.Drawing.Size(75,23)\n$OKButton.Text = \"OK\"\n$OKButton.DialogResult = [System.Windows.Forms.DialogResult]::OK\n$form.AcceptButton = $OKButton\n$form.Controls.Add($OKButton)\n\n$CancelButton = New-Object System.Windows.Forms.Button\n$CancelButton.Location = New-Object System.Drawing.Point(150,120)\n$CancelButton.Size = New-Object System.Drawing.Size(75,23)\n$CancelButton.Text = \"Cancel\"\n$CancelButton.DialogResult = [System.Windows.Forms.DialogResult]::Cancel\n$form.CancelButton = $CancelButton\n$form.Controls.Add($CancelButton)\n\n$label = New-Object System.Windows.Forms.Label\n$label.Location = New-Object System.Drawing.Point(10,20) \n$label.Size = New-Object System.Drawing.Size(280,20) \n$label.Text = \"Please select a computer:\"\n$form.Controls.Add($label) \n\n$listBox = New-Object System.Windows.Forms.ListBox \n$listBox.Location = New-Object System.Drawing.Point(10,40) \n$listBox.Size = New-Object System.Drawing.Size(260,20) \n$listBox.Height = 80\n\n[void] $listBox.Items.Add(\"atl-dc-001\")\n[void] $listBox.Items.Add(\"atl-dc-002\")\n[void] $listBox.Items.Add(\"atl-dc-003\")\n[void] $listBox.Items.Add(\"atl-dc-004\")\n[void] $listBox.Items.Add(\"atl-dc-005\")\n[void] $listBox.Items.Add(\"atl-dc-006\")\n[void] $listBox.Items.Add(\"atl-dc-007\")\n\n$form.Controls.Add($listBox) \n\n$form.Topmost = $True\n\n$result = $form.ShowDialog()\n\nif ($result -eq [System.Windows.Forms.DialogResult]::OK)\n{\n    $x = $listBox.SelectedItem\n    $x\n}\n```\n\nThe script begins by loading two .NET Framework classes: **System.Drawing** and **System.Windows.Forms**. You then start a new instance of the .NET Framework class **System.Windows.Forms.Form**; that provides a blank form or window to which you can start adding controls.\n\n```\nAdd-Type -AssemblyName System.Windows.Forms\nAdd-Type -AssemblyName System.Drawing\n```\n\nAfter you create an instance of the Form class, assign values to three properties of this class.\n\n-   **Text.** This becomes the title of the window.\n\n-   **Size.** This is the size of the form, in pixels. The preceding script creates a form that’s 300 pixels wide by 200 pixels tall.\n\n-   **StartingPosition.** This optional property is set to **CenterScreen** in the preceding script. If you don’t add this property, Windows selects a location when the form is opened. By setting the **StartingPosition** to **CenterScreen**, you’re automatically displaying the form in the middle of the screen each time it loads.\n\n```\n$form.Text = \"Select a Computer\"\n$form.Size = New-Object System.Drawing.Size(300,200) \n$form.StartPosition = \"CenterScreen\"\n```\n\nNext, create an **OK** button for your form. Specify the size and behavior of the **OK** button. In this example, the button position is 120 pixels from the form’s top edge, and 75 pixels from the left edge. The button height is 23 pixels, while the button length is 75 pixels. The script uses predefined Windows Forms types to determine the button behaviors.\n\n```\n$OKButton = New-Object System.Windows.Forms.Button\n$OKButton.Location = New-Object System.Drawing.Point(75,120)\n$OKButton.Size = New-Object System.Drawing.Size(75,23)\n$OKButton.Text = \"OK\"\n$OKButton.DialogResult = [System.Windows.Forms.DialogResult]::OK\n$form.AcceptButton = $OKButton\n$form.Controls.Add($OKButton)\n```\n\nSimilarly, you create a **Cancel** button. The **Cancel** button is 120 pixels from the top, but 150 pixels from the left edge of the window.\n\n```\n$CancelButton = New-Object System.Windows.Forms.Button\n$CancelButton.Location = New-Object System.Drawing.Point(150,120)\n$CancelButton.Size = New-Object System.Drawing.Size(75,23)\n$CancelButton.Text = \"Cancel\"\n$CancelButton.DialogResult = [System.Windows.Forms.DialogResult]::Cancel\n$form.CancelButton = $CancelButton\n$form.Controls.Add($CancelButton)\n```\n\nNext, provide label text on your window that describes the information you want users to provide. In this case, you want users to select a computer.\n\n```\n$label = New-Object System.Windows.Forms.Label\n$label.Location = New-Object System.Drawing.Point(10,20) \n$label.Size = New-Object System.Drawing.Size(280,20) \n$label.Text = \"Please select a computer:\"\n$form.Controls.Add($label)\n```\n\nAdd the control (in this case, a list box) that lets users provide the information you’ve described in your label text. There are many other controls you can apply besides list boxes; for more controls, see [System.Windows.Forms Namespace](http://msdn.microsoft.com/library/k50ex0x9(v=vs.110).aspx) on MSDN.\n\n```\n$listBox = New-Object System.Windows.Forms.ListBox \n$listBox.Location = New-Object System.Drawing.Point(10,40) \n$listBox.Size = New-Object System.Drawing.Size(260,20) \n$listBox.Height = 80\n```\n\nIn the next section, you specify the values you want the list box to display to users.\n\n> [!NOTE]\n> The list box created by this script allows only one selection. To create a list box control that allows multiple selections, specify a value for the **SelectionMode** property, similarly to the following:  `$listBox.SelectionMode = \"MultiExtended\"`. For more information, see [Multiple-selection List Boxes](Multiple-selection-List-Boxes.md).\n\n```\n[void] $listBox.Items.Add(\"atl-dc-001\")\n[void] $listBox.Items.Add(\"atl-dc-002\")\n[void] $listBox.Items.Add(\"atl-dc-003\")\n[void] $listBox.Items.Add(\"atl-dc-004\")\n[void] $listBox.Items.Add(\"atl-dc-005\")\n[void] $listBox.Items.Add(\"atl-dc-006\")\n[void] $listBox.Items.Add(\"atl-dc-007\")\n```\n\nAdd the list box control to your form, and instruct Windows to open the form atop other windows and dialog boxes when it’s opened.\n\n```\n$form.Controls.Add($listBox) \n$form.Topmost = $True\n```\n\nAdd the following line of code to display the form in Windows.\n\n```\n$result = $form.ShowDialog()\n```\n\nFinally, the code inside the **If** block instructs Windows what to do with the form after users select an option from the list box, and then click the **OK** button or press the **Enter** key.\n\n```\nif ($result -eq [System.Windows.Forms.DialogResult]::OK)\n{\n    $x = $listBox.SelectedItem\n    $x\n}\n```\n\n## See Also\n[Hey Scripting Guy:  Why don’t these PowerShell GUI examples work?](http://go.microsoft.com/fwlink/?LinkId=506644)\n[GitHub: Dave Wyatt's WinFormsExampleUpdates](https://github.com/dlwyatt/WinFormsExampleUpdates)\n[Windows PowerShell Tip of the Week:  Selecting Items from a List Box](http://technet.microsoft.com/library/ff730949.aspx)\n\n"}