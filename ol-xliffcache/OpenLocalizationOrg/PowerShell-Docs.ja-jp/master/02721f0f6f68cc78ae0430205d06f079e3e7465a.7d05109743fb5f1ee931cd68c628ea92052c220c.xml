{"nodes":[{"pos":[13,63],"content":"Setting up a pull client using configuration names","needQuote":true,"nodes":[{"content":"Setting up a pull client using configuration names","pos":[0,50]}]},{"pos":[96,110],"content":"powershell,DSC","needQuote":true,"nodes":[{"content":"powershell,DSC","pos":[0,14]}]},{"content":"Setting up a pull client using configuration names","pos":[208,258]},{"content":"Applies To: Windows PowerShell 5.0","pos":[262,296]},{"content":"Each target node has to be told to use pull mode and given the URL where it can contact the pull server to get configurations.","pos":[298,424]},{"content":"To do this, you have to configure the Local Configuration Manager (LCM) with the necessary information.To configure the LCM, you create a special type of configuration, decorated with the <bpt id=\"p1\">**</bpt>DSCLocalConfigurationManager<ept id=\"p1\">**</ept> attribute.","pos":[425,658],"source":" To do this, you have to configure the Local \nConfiguration Manager (LCM) with the necessary information.To configure the LCM, you create a special type of configuration, decorated with the **DSCLocalConfigurationManager** \nattribute."},{"content":"For more information about configuring the LCM, see <bpt id=\"p1\">[</bpt>Configuring the Local Configuration Manager<ept id=\"p1\">](metaConfig.md)</ept>.","pos":[659,772],"source":" For more information about configuring the LCM, see [Configuring the Local Configuration Manager](metaConfig.md)."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>: This topic applies to PowerShell 5.0.","pos":[776,823],"source":"**Note**: This topic applies to PowerShell 5.0."},{"content":"For information on setting up a pull client in PowerShell 4.0, see <bpt id=\"p1\">[</bpt>Setting up a pull client using configuration ID in PowerShell 4.0<ept id=\"p1\">](pullClientConfigID4.md)</ept>","pos":[824,983],"source":" For information on setting up a pull client in PowerShell 4.0, see [Setting up a pull client using configuration ID in \nPowerShell 4.0](pullClientConfigID4.md)"},{"content":"The following script configures the LCM to pull configurations from a server named \"CONTOSO-PullSrv\":","pos":[985,1086]},{"content":"In the script, the <bpt id=\"p1\">**</bpt>ConfigurationRepositoryWeb<ept id=\"p1\">**</ept> block defines the pull server.","pos":[1666,1746],"source":"In the script, the **ConfigurationRepositoryWeb** block defines the pull server."},{"content":"The <bpt id=\"p1\">**</bpt>ServerURL<ept id=\"p1\">**</ept> property specifies the endpoint for the pull server.","pos":[1747,1817],"source":" The **ServerURL** property specifies the endpoint for the pull server."},{"content":"The <bpt id=\"p1\">**</bpt>RegistrationKey<ept id=\"p1\">**</ept> property is a shared key between all client nodes for a pull server and that pull server.","pos":[1819,1932],"source":"The **RegistrationKey** property is a shared key between all client nodes for a pull server and that pull server."},{"content":"The same value is stored in a file on the pull server.","pos":[1933,1987]},{"content":"The <bpt id=\"p1\">**</bpt>ConfigurationNames<ept id=\"p1\">**</ept> property is an array that specifies the names of the configurations intended for the client node.","pos":[1990,2114],"source":"The **ConfigurationNames** property is an array that specifies the names of the configurations intended for the client node."},{"content":"On the pull server, the configuration MOF file for this client node must be named <bpt id=\"p1\">*</bpt>ConfigurationNames<ept id=\"p1\">*</ept>.mof, where <bpt id=\"p2\">*</bpt>ConfigurationNames<ept id=\"p2\">*</ept> matches the value of the <bpt id=\"p3\">**</bpt>ConfigurationNames<ept id=\"p3\">**</ept> property you set in this metaconfiguration.","pos":[2115,2342],"source":" On the pull server, the configuration MOF file for \nthis client node must be named *ConfigurationNames*.mof, where *ConfigurationNames* matches the value of the **ConfigurationNames** property you set in this metaconfiguration."},{"pos":[2345,2632],"content":"**Note:** If you specify more than one value in the **ConfigurationNames**, you must also specify **PartialConfiguration** blocks in your configuration. For information\nabout partial configurations, see [PowerShell Desired State Configuration partial configurations](partialConfigs.md).","leadings":["",">"],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> If you specify more than one value in the <bpt id=\"p2\">**</bpt>ConfigurationNames<ept id=\"p2\">**</ept>, you must also specify <bpt id=\"p3\">**</bpt>PartialConfiguration<ept id=\"p3\">**</ept> blocks in your configuration.","pos":[0,152],"source":"**Note:** If you specify more than one value in the **ConfigurationNames**, you must also specify **PartialConfiguration** blocks in your configuration."},{"content":"For information about partial configurations, see <bpt id=\"p1\">[</bpt>PowerShell Desired State Configuration partial configurations<ept id=\"p1\">](partialConfigs.md)</ept>.","pos":[153,286],"source":" For information\nabout partial configurations, see [PowerShell Desired State Configuration partial configurations](partialConfigs.md)."}]},{"content":"After this script runs, it creates a new output folder named <bpt id=\"p1\">**</bpt>PullClientConfigNames<ept id=\"p1\">**</ept> and puts a metaconfiguration MOF file there.","pos":[2634,2765],"source":"After this script runs, it creates a new output folder named **PullClientConfigNames** and puts a metaconfiguration MOF file there."},{"content":"In this case, the metaconfiguration MOF file will be named <ph id=\"ph1\">`localhost.meta.mof`</ph>.","pos":[2766,2846],"source":" In this case, the metaconfiguration MOF file will be named `localhost.meta.mof`."},{"content":"To apply the configuration, call the <bpt id=\"p1\">**</bpt>Set-DscLocalConfigurationManager<ept id=\"p1\">**</ept> cmdlet, with the <bpt id=\"p2\">**</bpt>Path<ept id=\"p2\">**</ept> set to the location of the metaconfiguration MOF file.","pos":[2848,3002],"source":"To apply the configuration, call the **Set-DscLocalConfigurationManager** cmdlet, with the **Path** set to the location of the metaconfiguration MOF file."},{"content":"For example: <ph id=\"ph1\">`Set-DSCLocalConfigurationManager localhost –Path .\\PullClientConfigNames –Verbose.`</ph>","pos":[3003,3100],"source":" For example: `Set-DSCLocalConfigurationManager localhost –Path .\\PullClientConfigNames –Verbose.`"},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>: Registration keys work only with web pull servers.","pos":[3104,3164],"source":"**Note**: Registration keys work only with web pull servers."},{"content":"You must still use <bpt id=\"p1\">**</bpt>ConfigurationID<ept id=\"p1\">**</ept> with an SMB pull server.","pos":[3165,3228],"source":" You must still use **ConfigurationID** with an SMB pull server."},{"content":"For information about configuring a pull server by using <bpt id=\"p1\">**</bpt>ConfigurationID<ept id=\"p1\">**</ept>, see <bpt id=\"p2\">[</bpt>Setting up a pull client using configuration ID<ept id=\"p2\">](PullClientConfigNames.md)</ept>","pos":[3229,3387],"source":" For information about configuring a pull server \nby using **ConfigurationID**, see [Setting up a pull client using configuration ID](PullClientConfigNames.md)"},{"content":"Resource and report servers","pos":[3392,3419]},{"content":"If you specify only a <bpt id=\"p1\">**</bpt>ConfigurationRepositoryWeb<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>ConfigurationRepositoryShare<ept id=\"p2\">**</ept> block in your LCM configuration (as in the previous example), the pull client will pull resources from the specified server, but it will not send reports to it.","pos":[3421,3671],"source":"If you specify only a **ConfigurationRepositoryWeb** or **ConfigurationRepositoryShare** block in your LCM configuration (as in the previous example), the pull client will pull \nresources from the specified server, but it will not send reports to it."},{"content":"You can use a single pull server for configurations, resources, and reporting, but you have to create a <bpt id=\"p1\">**</bpt>ReportRepositoryWeb<ept id=\"p1\">**</ept> block to set up reporting.","pos":[3672,3827],"source":" You can use a single pull server for configurations, resources, and reporting, but you have to create a \n**ReportRepositoryWeb** block to set up reporting."},{"content":"The following example shows a metaconfiguration that sets up a client to pull configurations and resources, and send reporting data, to a single pull server.","pos":[3828,3986],"source":" The following example shows a metaconfiguration that sets up a client to pull configurations and resources, and send reporting \ndata, to a single pull server."},{"content":"You can also specify different pull servers for resources and reporting.","pos":[4641,4713]},{"content":"To specify a resource server, you use either a <bpt id=\"p1\">**</bpt>ResourceRepositoryWeb<ept id=\"p1\">**</ept> (for a web pull server) or a <bpt id=\"p2\">**</bpt>ResourceRepositoryShare<ept id=\"p2\">**</ept> block (for an SMB pull server).","pos":[4714,4876],"source":" To specify a resource server, you use either a **ResourceRepositoryWeb** (for a web pull server) or a \n**ResourceRepositoryShare** block (for an SMB pull server)."},{"content":"To specify a report server, you use a <bpt id=\"p1\">**</bpt>ReportRepositoryWeb<ept id=\"p1\">**</ept> block.","pos":[4877,4945],"source":"\nTo specify a report server, you use a **ReportRepositoryWeb** block."},{"content":"A report server cannot be an SMB server.","pos":[4946,4986]},{"content":"The following metaconfiguration configures a pull client to get its configurations from <bpt id=\"p1\">**</bpt>CONTOSO-PullSrv<ept id=\"p1\">**</ept> and its resources from <bpt id=\"p2\">**</bpt>CONTOSO-ResourceSrv<ept id=\"p2\">**</ept>, and to send status reports to <bpt id=\"p3\">**</bpt>CONTOSO-ReportSrv<ept id=\"p3\">**</ept>:","pos":[4987,5196],"source":"\nThe following metaconfiguration configures a pull client to get its configurations from **CONTOSO-PullSrv** and its resources from **CONTOSO-ResourceSrv**, and to send status \nreports to **CONTOSO-ReportSrv**:"},{"content":"See Also","pos":[6146,6154]},{"pos":[6158,6232],"content":"<bpt id=\"p1\">[</bpt>Setting up a pull client with configuration ID<ept id=\"p1\">](PullClientConfigNames.md)</ept>","source":"[Setting up a pull client with configuration ID](PullClientConfigNames.md)"},{"pos":[6235,6284],"content":"<bpt id=\"p1\">[</bpt>Setting up a DSC web pull server<ept id=\"p1\">](pullServer.md)</ept>","source":"[Setting up a DSC web pull server](pullServer.md)"}],"content":"---\ntitle:   Setting up a pull client using configuration names\nms.date:  2016-05-16\nkeywords:  powershell,DSC\ndescription:  \nms.topic:  article\nauthor:  eslesar\nmanager:  dongill\nms.prod:  powershell\n---\n\n# Setting up a pull client using configuration names\n\n> Applies To: Windows PowerShell 5.0\n\nEach target node has to be told to use pull mode and given the URL where it can contact the pull server to get configurations. To do this, you have to configure the Local \nConfiguration Manager (LCM) with the necessary information.To configure the LCM, you create a special type of configuration, decorated with the **DSCLocalConfigurationManager** \nattribute. For more information about configuring the LCM, see [Configuring the Local Configuration Manager](metaConfig.md).\n\n> **Note**: This topic applies to PowerShell 5.0. For information on setting up a pull client in PowerShell 4.0, see [Setting up a pull client using configuration ID in \nPowerShell 4.0](pullClientConfigID4.md)\n\nThe following script configures the LCM to pull configurations from a server named \"CONTOSO-PullSrv\":\n\n```powershell\n[DSCLocalConfigurationManager()]\nconfiguration PullClientConfigNames\n{\n    Node localhost\n    {\n        Settings\n        {\n            RefreshMode = 'Pull'\n            RefreshFrequencyMins = 30 \n            RebootNodeIfNeeded = $true\n        }\n        ConfigurationRepositoryWeb CONTOSO-PullSrv\n        {\n            ServerURL = 'https://CONTOSO-PullSrv:8080/PSDSCPullServer.svc'\n            RegistrationKey = '140a952b-b9d6-406b-b416-e0f759c9c0e4'\n            ConfigurationNames = @('ClientConfig')\n            \n        }      \n    }\n}\nPullClientConfigNames\n```\n\nIn the script, the **ConfigurationRepositoryWeb** block defines the pull server. The **ServerURL** property specifies the endpoint for the pull server.\n\nThe **RegistrationKey** property is a shared key between all client nodes for a pull server and that pull server. The same value is stored in a file on the pull server. \n\nThe **ConfigurationNames** property is an array that specifies the names of the configurations intended for the client node. On the pull server, the configuration MOF file for \nthis client node must be named *ConfigurationNames*.mof, where *ConfigurationNames* matches the value of the **ConfigurationNames** property you set in this metaconfiguration.\n\n>**Note:** If you specify more than one value in the **ConfigurationNames**, you must also specify **PartialConfiguration** blocks in your configuration. For information\n>about partial configurations, see [PowerShell Desired State Configuration partial configurations](partialConfigs.md).\n\nAfter this script runs, it creates a new output folder named **PullClientConfigNames** and puts a metaconfiguration MOF file there. In this case, the metaconfiguration MOF file will be named `localhost.meta.mof`.\n\nTo apply the configuration, call the **Set-DscLocalConfigurationManager** cmdlet, with the **Path** set to the location of the metaconfiguration MOF file. For example: `Set-DSCLocalConfigurationManager localhost –Path .\\PullClientConfigNames –Verbose.`\n\n> **Note**: Registration keys work only with web pull servers. You must still use **ConfigurationID** with an SMB pull server. For information about configuring a pull server \nby using **ConfigurationID**, see [Setting up a pull client using configuration ID](PullClientConfigNames.md)\n\n## Resource and report servers\n\nIf you specify only a **ConfigurationRepositoryWeb** or **ConfigurationRepositoryShare** block in your LCM configuration (as in the previous example), the pull client will pull \nresources from the specified server, but it will not send reports to it. You can use a single pull server for configurations, resources, and reporting, but you have to create a \n**ReportRepositoryWeb** block to set up reporting. The following example shows a metaconfiguration that sets up a client to pull configurations and resources, and send reporting \ndata, to a single pull server.\n\n```powershell\n[DSCLocalConfigurationManager()]\nconfiguration PullClientConfigNames\n{\n    Node localhost\n    {\n        Settings\n        {\n            RefreshMode = 'Pull'\n            RefreshFrequencyMins = 30 \n            RebootNodeIfNeeded = $true\n        }\n\n        ConfigurationRepositoryWeb CONTOSO-PullSrv\n        {\n            ServerURL = 'https://CONTOSO-PullSrv:8080/PSDSCPullServer.svc'\n            RegistrationKey = 'fbc6ef09-ad98-4aad-a062-92b0e0327562'\n        }\n        \n        ReportServerWeb CONTOSO-PullSrv\n        {\n            ServerURL = 'https://CONTOSO-PullSrv:8080/PSDSCPullServer.svc'\n        }\n    }\n}\nPullClientConfigNames\n```\n\nYou can also specify different pull servers for resources and reporting. To specify a resource server, you use either a **ResourceRepositoryWeb** (for a web pull server) or a \n**ResourceRepositoryShare** block (for an SMB pull server).\nTo specify a report server, you use a **ReportRepositoryWeb** block. A report server cannot be an SMB server.\nThe following metaconfiguration configures a pull client to get its configurations from **CONTOSO-PullSrv** and its resources from **CONTOSO-ResourceSrv**, and to send status \nreports to **CONTOSO-ReportSrv**:\n\n```powershell\n[DSCLocalConfigurationManager()]\nconfiguration PullClientConfigNames\n{\n    Node localhost\n    {\n        Settings\n        {\n            RefreshMode = 'Pull'\n            RefreshFrequencyMins = 30 \n            RebootNodeIfNeeded = $true\n        }\n\n        ConfigurationRepositoryWeb CONTOSO-PullSrv\n        {\n            ServerURL = 'https://CONTOSO-PullSrv:8080/PSDSCPullServer.svc'\n            RegistrationKey = 'fbc6ef09-ad98-4aad-a062-92b0e0327562'\n        }\n        \n        ResourceRepositoryWeb CONTOSO-ResourceSrv\n        {\n            ServerURL = 'https://CONTOSO-ResourceSrv:8080/PSDSCPullServer.svc'\n            RegistrationKey = '30ef9bd8-9acf-4e01-8374-4dc35710fc90'\n        }\n\n        ReportServerWeb CONTOSO-ReportSrv\n        {\n            ServerURL = 'https://CONTOSO-ReportSrv:8080/PSDSCPullServer.svc'\n            RegistrationKey = '6b392c6a-818c-4b24-bf38-47124f1e2f14'\n        }\n    }\n}\nPullClientConfigNames\n```\n\n## See Also\n\n* [Setting up a pull client with configuration ID](PullClientConfigNames.md)\n* [Setting up a DSC web pull server](pullServer.md)\n\n"}