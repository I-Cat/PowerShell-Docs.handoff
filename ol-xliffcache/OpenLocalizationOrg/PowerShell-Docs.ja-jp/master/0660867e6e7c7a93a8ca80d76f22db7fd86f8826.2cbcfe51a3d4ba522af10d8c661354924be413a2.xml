{"nodes":[{"content":"Improvements in PowerShell Script Debugging","pos":[2,45]},{"content":"A number of improvements were made in PowerShell 5.0 to enhance the debugging experience:","pos":[47,136]},{"content":"Break All","pos":[141,150]},{"content":"The PowerShell console and Windows PowerShell ISE now allow you to break into the debugger for running scripts.","pos":[152,263]},{"content":"This works in both local and remote sessions.","pos":[264,309]},{"pos":[311,348],"content":"In the console, press <bpt id=\"p1\">**</bpt>Ctrl+Break<ept id=\"p1\">**</ept>.","source":"In the console, press **Ctrl+Break**."},{"pos":[350,423],"content":"In ISE, press <bpt id=\"p1\">**</bpt>Ctrl+B<ept id=\"p1\">**</ept>, or use the <bpt id=\"p2\">**</bpt>Debug -&gt; Break All<ept id=\"p2\">**</ept> menu command.","source":"In ISE, press **Ctrl+B**, or use the **Debug -> Break All** menu command."},{"content":"Remote debugging and remote file editing in Windows PowerShell ISE","pos":[428,494]},{"content":"Windows PowerShell ISE now lets you open and edit files in a remote session by running the PSEdit command.","pos":[496,602]},{"content":"For example, you can open a file for editing from the command line in a remote session as follows:","pos":[603,701],"source":"\nFor example, you can open a file for editing from the command line in a remote session as follows:"},{"content":"In addition, you can now edit and save changes in a remote file that is automatically opened in Windows PowerShell ISE when you hit a breakpoint.","pos":[794,939]},{"content":"Now, you can debug a script file that is running on a remote computer, edit the file to fix an error, and then rerun the modified script.","pos":[940,1077],"source":"\nNow, you can debug a script file that is running on a remote computer, edit the file to fix an error, and then rerun the modified script."},{"content":"Advanced Script Debugging","pos":[1082,1107]},{"content":"There are new, advanced debugging features that let you attach to any local computer process that has loaded Windows PowerShell, and debug arbitrary runspaces in that process.","pos":[1109,1284]},{"content":"Runspace Debugging","pos":[1290,1308]},{"content":"New cmdlets have been added that let you list current runspaces in a process, and attach the Windows PowerShell console or ISE debugger to that runspace for script debugging:","pos":[1310,1484]},{"content":"Get-Runspace","pos":[1490,1502]},{"content":"Debug-Runspace","pos":[1507,1521]},{"content":"Enable-RunspaceDebug","pos":[1526,1546]},{"content":"Disable-RunspaceDebug","pos":[1551,1572]},{"content":"Get-RunspaceDebug","pos":[1577,1594]},{"content":"Attach to Process hosting PowerShell","pos":[1600,1636]},{"content":"You can now attach to any computer process that has Windows PowerShell loaded.","pos":[1638,1716]},{"content":"You do this by entering into an interactive session with the process, similarly to how you enter into an interactive remote session by running the Enter-PSSession cmdlet:","pos":[1717,1887]},{"content":"Enter-PSHostProcess","pos":[1893,1912]},{"content":"Exit-PSHostProcess","pos":[1917,1935]}],"content":"# Improvements in PowerShell Script Debugging\n\nA number of improvements were made in PowerShell 5.0 to enhance the debugging experience:\n\n## Break All\n\nThe PowerShell console and Windows PowerShell ISE now allow you to break into the debugger for running scripts. This works in both local and remote sessions.\n\nIn the console, press **Ctrl+Break**.\n\nIn ISE, press **Ctrl+B**, or use the **Debug -> Break All** menu command.\n\n## Remote debugging and remote file editing in Windows PowerShell ISE\n\nWindows PowerShell ISE now lets you open and edit files in a remote session by running the PSEdit command.\nFor example, you can open a file for editing from the command line in a remote session as follows:\n\n```powershell\n[RemoteComputer1]: PS C:\\> PSEdit C:\\DebugDemoScripts\\Test-GetMutex.ps1\n```\n\nIn addition, you can now edit and save changes in a remote file that is automatically opened in Windows PowerShell ISE when you hit a breakpoint.\nNow, you can debug a script file that is running on a remote computer, edit the file to fix an error, and then rerun the modified script.\n\n## Advanced Script Debugging\n\nThere are new, advanced debugging features that let you attach to any local computer process that has loaded Windows PowerShell, and debug arbitrary runspaces in that process.\n\n### Runspace Debugging\n\nNew cmdlets have been added that let you list current runspaces in a process, and attach the Windows PowerShell console or ISE debugger to that runspace for script debugging:\n\n-   Get-Runspace\n-   Debug-Runspace\n-   Enable-RunspaceDebug\n-   Disable-RunspaceDebug\n-   Get-RunspaceDebug\n\n### Attach to Process hosting PowerShell\n\nYou can now attach to any computer process that has Windows PowerShell loaded. You do this by entering into an interactive session with the process, similarly to how you enter into an interactive remote session by running the Enter-PSSession cmdlet:\n\n-   Enter-PSHostProcess\n-   Exit-PSHostProcess"}