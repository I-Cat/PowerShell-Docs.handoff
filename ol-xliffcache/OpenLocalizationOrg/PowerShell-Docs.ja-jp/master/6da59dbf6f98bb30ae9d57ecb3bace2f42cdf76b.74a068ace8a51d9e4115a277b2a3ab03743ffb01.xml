{"nodes":[{"content":"Update-ScriptFileInfo","pos":[2,23]},{"content":"Update-ScriptFileInfo cmdlet lets you to update the existing script file metadata.","pos":[25,107]},{"content":"Description","pos":[112,123]},{"content":"The Update-ScriptFileInfo cmdlet updates information for a script.","pos":[125,191]},{"content":"Update-ScriptFileInfo cmdlet updates the metadata of a script file only if it was created using New-ScriptFileInfo cmdlet or with valid PSScriptInfo comment.","pos":[194,351]},{"content":"Also allows you to add the script file information to the existing script files which were not created using New-ScriptFileInfo cmdlet.","pos":[354,489]},{"content":"If –Force is specified, try to add the metadata to the existing script file which was not created using New-ScriptFileInfo cmdlet.","pos":[492,622]},{"content":"If Test-ScriptFileInfo fails with the parsing errors, after prepending the script metadata to the existing file, an error will be thrown saying something like \"unable to add the metadata to the existing file, you can use the new-scriptfileinfo cmdlet to add the metadata to the existing script file which was not created using New-ScriptFileInfo cmdlet.\"","pos":[625,979]},{"content":"Cmdlet syntax","pos":[984,997]},{"content":"Cmdlet online help reference","pos":[1090,1118]},{"pos":[1120,1182],"content":"<bpt id=\"p1\">[</bpt>Update-Script<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=619793)</ept>","source":"[Update-Script](http://go.microsoft.com/fwlink/?LinkId=619793)"},{"content":"Example commands","pos":[1187,1203]},{"content":"Adding the script metadata to the existing script file","pos":[1599,1653]}],"content":"# Update-ScriptFileInfo\n\nUpdate-ScriptFileInfo cmdlet lets you to update the existing script file metadata.\n\n## Description\n\nThe Update-ScriptFileInfo cmdlet updates information for a script.\n- Update-ScriptFileInfo cmdlet updates the metadata of a script file only if it was created using New-ScriptFileInfo cmdlet or with valid PSScriptInfo comment.\n- Also allows you to add the script file information to the existing script files which were not created using New-ScriptFileInfo cmdlet.\n- If –Force is specified, try to add the metadata to the existing script file which was not created using New-ScriptFileInfo cmdlet.\n- If Test-ScriptFileInfo fails with the parsing errors, after prepending the script metadata to the existing file, an error will be thrown saying something like \"unable to add the metadata to the existing file, you can use the new-scriptfileinfo cmdlet to add the metadata to the existing script file which was not created using New-ScriptFileInfo cmdlet.\"\n\n## Cmdlet syntax\n\n```powershell\nGet-Command -Name Update-ScriptFileInfo -Module PowerShellGet -Syntax\n```\n## Cmdlet online help reference\n\n[Update-Script](http://go.microsoft.com/fwlink/?LinkId=619793)\n\n## Example commands\n\n```powershell\n# Use Update-ScriptFileInfo cmdlet to update the script metadata\nUpdate-ScriptFileInfo -Path C:\\ScriptSharingDemo\\Demo-ScriptWithCompletePSScriptInfo.ps1 -Version 2.0\n\nTest-ScriptFileInfo C:\\ScriptSharingDemo\\Demo-ScriptWithCompletePSScriptInfo.ps1\n\nVersion Name Author Description\n------- ---- ------ -----------\n2.0 Demo-ScriptWithComplet... manikb my new script file\n```\n\n\n### Adding the script metadata to the existing script file\n\n```powershell\nPS C:\\WINDOWS\\system32> New-ScriptFileInfo -Description \"Script file description.\" -PassThru\n\n<#PSScriptInfo\n\n.VERSION 1.0\n\n.GUID 1cfd45e7-4219-4cd2-af21-d8577476be09\n\n.AUTHOR manikb\n\n.COMPANYNAME\n\n.COPYRIGHT\n\n.TAGS\n\n.LICENSEURI\n\n.PROJECTURI\n\n.ICONURI\n\n.EXTERNALMODULEDEPENDENCIES\n\n.REQUIREDSCRIPTS\n\n.EXTERNALSCRIPTDEPENDENCIES\n\n.RELEASENOTES\n\n\n#>\n\n<#\n\n.DESCRIPTION\nScript file description.\n\n#>\nParam()\n\n\nPS C:\\WINDOWS\\system32> $content = @'\n   Function foo\n   {\n   \"Foo\"\n   }\n>>\n   Foo\n'@\n\nPS C:\\WINDOWS\\system32>\nPS C:\\WINDOWS\\system32> Set-Content -Value $content -Path C:\\temp\\ScriptFileWithoutMetadata.ps1 -Force\nPS C:\\WINDOWS\\system32> Test-ScriptFileInfo c:\\temp\\ScriptFileWithoutMetadata.ps1\nTest-ScriptFileInfo : PSScriptInfo is not specified in the script file 'C:\\temp\\ScriptFileWithoutMetadata.ps1', use the Update-ScriptFileInfo with -Force \nor New-ScriptFileInfo cmdlet to add the PSScriptInfo to the script file.\nAt line:1 char:1\n+ Test-ScriptFileInfo c:\\temp\\ScriptFileWithoutMetadata.ps1\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidArgument: (C:\\temp\\ScriptFileWithoutMetadata.ps1:String) [Test-ScriptFileInfo], ArgumentException\n    + FullyQualifiedErrorId : MissingPSScriptInfo,Test-ScriptFileInfo\n\nPS C:\\WINDOWS\\system32> # Should Fail\nPS C:\\WINDOWS\\system32> Update-ScriptFileInfo c:\\temp\\ScriptFileWithoutMetadata.ps1\nTest-ScriptFileInfo : PSScriptInfo is not specified in the script file 'C:\\temp\\ScriptFileWithoutMetadata.ps1', use the Update-ScriptFileInfo with -Force \nor New-ScriptFileInfo cmdlet to add the PSScriptInfo to the script file.\nAt C:\\Program Files\\WindowsPowerShell\\Modules\\PowerShellGet\\1.0.0.1\\PSModule.psm1:4704 char:29\n+ ...      $psscriptInfo = Test-ScriptFileInfo -LiteralPath $scriptFilePath\n+                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidArgument: (C:\\temp\\ScriptFileWithoutMetadata.ps1:String) [Test-ScriptFileInfo], ArgumentException\n    + FullyQualifiedErrorId : MissingPSScriptInfo,Test-ScriptFileInfo\n\nPS C:\\WINDOWS\\system32> # Should Fail\nPS C:\\WINDOWS\\system32> Update-ScriptFileInfo c:\\temp\\ScriptFileWithoutMetadata.ps1 -Force\nUpdate-ScriptFileInfo : Description parameter is missing for adding the metadata to script file. Try again after specifying the description.\nAt line:1 char:1\n+ Update-ScriptFileInfo c:\\temp\\ScriptFileWithoutMetadata.ps1 -Force\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidArgument: (:) [Update-ScriptFileInfo], ArgumentException\n    + FullyQualifiedErrorId : DescriptionParameterIsMissingForAddingTheScriptFileInfo,Update-ScriptFileInfo\n\nPS C:\\WINDOWS\\system32> Update-ScriptFileInfo c:\\temp\\ScriptFileWithoutMetadata.ps1 -Force -Description \"Temp script file.\"\nPS C:\\WINDOWS\\system32> Test-ScriptFileInfo c:\\temp\\ScriptFileWithoutMetadata.ps1\n\nVersion    Name                      Author               Description\n-------    ----                      ------               -----------\n1.0        ScriptFileWithoutMetadata manikb               Temp script file.\n\n\nPS C:\\WINDOWS\\system32> Get-Content c:\\temp\\ScriptFileWithoutMetadata.ps1\n\n<#PSScriptInfo\n\n.VERSION 1.0\n\n.GUID 855821be-811c-4eb1-a7a7-afd6081be175\n\n.AUTHOR manikb\n\n.COMPANYNAME\n\n.COPYRIGHT\n\n.TAGS\n\n.LICENSEURI\n\n.PROJECTURI\n\n.ICONURI\n\n.EXTERNALMODULEDEPENDENCIES\n\n.REQUIREDSCRIPTS\n\n.EXTERNALSCRIPTDEPENDENCIES\n\n.RELEASENOTES\n\n\n#>\n\n<#\n\n.DESCRIPTION\nTemp script file.\n\n#>\n\nParam()\n\n\nFunction foo\n{\n\"Foo\"\n}\n\nFoo\n\n```"}