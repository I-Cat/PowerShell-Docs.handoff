{"nodes":[{"content":"PowerShellGet Cmdlets for Script Management","pos":[2,45]},{"content":"Find-Script cmdlet","pos":[50,68]},{"content":"Find-Script cmdlet lets you to discover the script files with different search criteria like name, tag, filter, command name, version range, exact version, all versions, including its dependencies and from specific or all registered repositories.","pos":[69,315]},{"content":"Example usage:","pos":[317,331]},{"content":"Save-Script cmdlet","pos":[7489,7507]},{"content":"Save-Script cmdlet lets you to review the script file by saving it to a specified location.","pos":[7508,7599]},{"content":"Install-Script and Get-InstalledScript cmdlets","pos":[8091,8137]},{"content":"Install-Script cmdlet lets you to install a specific script file along with its dependencies to the specified scope.","pos":[8138,8254]},{"content":"By default, scripts are installed to the AllUsers scope.","pos":[8255,8311]},{"content":"Get-InstalledScript cmdlet lets you to get the list of script files which were installed using Install-Script cmdlet.","pos":[8312,8429]},{"content":"Use note: To allow management and locating of scripts once they are installed, Install-script will create a default folder for storing scripts at $home\\Documents\\WindowsPowerShell\\Scripts, and add that folder to your PATH environment.","pos":[8431,8665]},{"content":"If modifying the path is a concern, use Save-Script instead of Install-Script.","pos":[8666,8744]},{"content":"Get-InstalledScripts and Uninstall-Script can only work with scripts placed on the system using Install-Script.","pos":[8745,8856]},{"content":"You can also use Get-Command –Name <ph id=\"ph1\">&amp;lt;</ph>InstalledScriptFileName<ph id=\"ph2\">&amp;gt;</ph> to get it.","pos":[11953,12030],"source":"You can also use Get-Command –Name &lt;InstalledScriptFileName&gt; to get it."},{"content":"Two install locations are added to the PATH environment variable on first use of a specified scope.","pos":[12031,12130]},{"content":"Update-Script cmdlet","pos":[17871,17891]},{"content":"Update-Script cmdlet lets you to do in-place update of the script files which were installed using Install-Script cmdlet.","pos":[17892,18013]},{"content":"Uninstall-Script cmdlet","pos":[20182,20205]},{"content":"New-ScriptFileInfo and Test-ScriptFileInfo cmdlets","pos":[22977,23027]},{"content":"New-ScriptFileInfo cmdlet lets you to create a new script file with metadata like Version, Guid, Author, and Description, etc. Test-ScriptFileInfo cmdlet lets you to validate and get the script file metadata.","pos":[23028,23236]},{"content":"Update-ScriptFileInfo cmdlet","pos":[29056,29084]},{"content":"Update-ScriptFileInfo cmdlet lets you to update the existing script file metadata.","pos":[29085,29167]},{"content":"Register-PSRepository and Set-PSRepository cmdlets with script sharing support","pos":[29563,29641]},{"pos":[29642,29779],"content":"Use Register-PSRepository/Set-PSRepository cmdlets to add the <bpt id=\"p1\">**</bpt>ScriptSourceLocation<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>ScriptPublishLocation<ept id=\"p2\">**</ept> to the PSRepository.","source":"Use Register-PSRepository/Set-PSRepository cmdlets to add the **ScriptSourceLocation** and **ScriptPublishLocation** to the PSRepository."},{"content":"Publish-Script cmdlet","pos":[33324,33345]},{"content":"Publish-Script cmdlet lets you to publish your script file with valid metadata like Version, Guid, Author, and Description, etc.","pos":[33346,33474]}],"content":"# PowerShellGet Cmdlets for Script Management\n\n## Find-Script cmdlet\nFind-Script cmdlet lets you to discover the script files with different search criteria like name, tag, filter, command name, version range, exact version, all versions, including its dependencies and from specific or all registered repositories.\n\nExample usage:\n```powershell\n\\# Find a script from the registered repository with ScriptSourceLocation\nFind-Script -Repository GalleryINT -Name Required-Script2\n\n\\# Find all available scripts in a specified repository\nFind-Script -Repository GalleryINT\n\n\\# Find script output with all properties in PSRepositoryItemInfo object.\nFind-Script -Name Required-Script2 -RequiredVersion 2.0 -Repository GalleryINT | Format-List \\* -Force\n\n\\# Find a script within the specified minimum and maximum version range.\nFind-Script -Name Required-Script2 -MinimumVersion 2.1 -MaximumVersion 2.5 -Repository GalleryINT\n\n\\# Find a script from the registered repository with ScriptSourceLocation\nFind-Script -Repository GalleryINT -Name Required-Script2\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n\n\\# Find all available scripts in a specified repository\nFind-Script -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Fabrikam-ServerScript Script GalleryINT Description for the Fabrikam-ServerScript script\n2.5 Fabrikam-ClientScript Script GalleryINT Description for the Fabrikam-ClientScript script\n3.0 TestScript Script GalleryINT This is a test script\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.5 Required-Script1 Script GalleryINT Description for the Required-Script1 script\n2.5 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n2.0 Script-WithDependencies1 Script GalleryINT Description for the Script-WithDependencies1 script\n2.5 Fabrikam-Script Script GalleryINT Description for the Fabrikam-Script script\n2.0 Script-WithDependencies2 Script GalleryINT Description for the Script-WithDependencies2 script\n\n\\# Find script output with all properties in PSRepositoryItemInfo object.\nFind-Script -Name Required-Script2 -RequiredVersion 2.0 -Repository GalleryINT | Format-List \\* -Force\nName : Required-Script2\nVersion : 2.0\nType : Script\nDescription : Description for the Required-Script2 script\nAuthor : manikb\nCompanyName :\nCopyright : (c) 2015 Microsoft Corporation. All rights reserved.\nPublishedDate : 10/30/2015 1:25:11 AM\nLicenseUri : http://required-script2.com/license\nProjectUri : http://required-script2.com/\nIconUri : http://required-script2.com/icon\nTags : {Tag1, Tag2, Tag-Required-Script2-2.0, PSScript}\nIncludes : {Function, DscResource, Cmdlet, Workflow...}\nPowerShellGetFormatVersion :\nReleaseNotes : Required-Script2 release notes\nDependencies : {}\nRepositorySourceLocation : https://customgallery.cloudapp.net/api/v2/\nRepository : GalleryINT\nPackageManagementProvider : NuGet\nAdditionalMetadata : {Created, ItemType, copyright, PackageManagementProvider...}\n\n\\# Find a script within the specified minimum and maximum version range.\nFind-Script -Name Required-Script2 -MinimumVersion 2.1 -MaximumVersion 2.5 -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n\n\\# Find all versions of a script.\nFind-Script -Name Required-Script2 -AllVersions -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.0 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n1.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n1.0 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n\n\\# Find script with wildcards\nFind-Script -Name Required-Script\\* -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.5 Required-Script1 Script GalleryINT Description for the Required-Script1 script\n2.5 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n\n\\# Find a script with its dependent modules and scripts\nFind-Script -Name Script-WithDependencies1 -IncludeDependencies -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.0 Script-WithDependencies1 Script GalleryINT Description for the Script-WithDependencies1 script\n2.5 RequiredModule1 Module GalleryINT RequiredModule1 module\n2.5 RequiredModule2 Module GalleryINT RequiredModule2 module\n2.5 RequiredModule3 Module GalleryINT RequiredModule3 module\n2.0 RequiredModule4 Module GalleryINT RequiredModule4 module\n1.5 RequiredModule5 Module GalleryINT RequiredModule5 module\n2.5 Required-Script1 Script GalleryINT Description for the Required-Script1 script\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.5 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n\n\\# Find scripts with specified command name\nFind-Script -Tag Tag-Fabrikam-ClientScript-2.5 -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Fabrikam-ClientScript Script GalleryINT Description for the Fabrikam-ClientScript script\n\n\\# Find scripts with -Filter\nFind-Script -Filter ServerScript -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Fabrikam-ServerScript Script GalleryINT Description for the Fabrikam-ServerScript script\n\n\\# Find scripts with specified command name\nFind-Script -Command Test-FunctionFromScript\\_Required-Script3 -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n\n\\# Find scripts with workflows\nFind-Script -Includes Workflow -Repository GalleryINT\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Fabrikam-ServerScript Script GalleryINT Description for the Fabrikam-ServerScript script\n2.5 Fabrikam-ClientScript Script GalleryINT Description for the Fabrikam-ClientScript script\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.5 Required-Script1 Script GalleryINT Description for the Required-Script1 script\n2.5 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n2.0 Script-WithDependencies1 Script GalleryINT Description for the Script-WithDependencies1 script\n2.5 Fabrikam-Script Script GalleryINT Description for the Fabrikam-Script script\n2.0 Script-WithDependencies2 Script GalleryINT Description for the Script-WithDependencies2 script\n1.0 PSGTEST-ScriptMetadata Script GalleryINT This sample file is used to test script metadata.\n $t = Find-Script -Includes Workflow -Repository GalleryINT -Name Fabrikam-ClientScript\n $t.Includes\nName Value\n---- -----\nFunction {Test-FunctionFromScript\\_Fabrikam-ClientScript}\nDscResource {}\nCmdlet {}\nWorkflow {Test-WorkflowFromScript\\_Fabrikam-ClientScript}\nCommand {Test-FunctionFromScript\\_Fabrikam-ClientScript, Test-WorkflowFromScript\\_Fabrikam-ClientScript}\n```\n\n## Save-Script cmdlet\nSave-Script cmdlet lets you to review the script file by saving it to a specified location.\n```powershell\n\\# Save a script file to the specified location for the script analysis\n\\# Piping the Find-Script output to Save-Script cmdlet\nFind-Script -Name Fabrikam-ClientScript -Repository GalleryINT -RequiredVersion 1.5 | Save-Script -Path C:\\\\ScriptSharingDemo\nTest-ScriptFileInfo C:\\\\ScriptSharingDemo\\\\Fabrikam-ClientScript.ps1\n\nVersion Name Author Description\n------- ---- ------ -----------\n1.5 Fabrikam-ClientScript manikb Description for the Fabrikam-ClientScript script\n```\n\n## Install-Script and Get-InstalledScript cmdlets\nInstall-Script cmdlet lets you to install a specific script file along with its dependencies to the specified scope. By default, scripts are installed to the AllUsers scope. Get-InstalledScript cmdlet lets you to get the list of script files which were installed using Install-Script cmdlet.\n\nUse note: To allow management and locating of scripts once they are installed, Install-script will create a default folder for storing scripts at $home\\Documents\\WindowsPowerShell\\Scripts, and add that folder to your PATH environment. If modifying the path is a concern, use Save-Script instead of Install-Script. Get-InstalledScripts and Uninstall-Script can only work with scripts placed on the system using Install-Script.\n```powershell\n\\# Install locations for scripts:\n\\# Default scope is AllUsers.\n\\# AllUsers scope --&gt; \"$env:ProgramFiles\\\\WindowsPowerShell\\\\Scripts\"\n\\# CurrentUser scope --&gt; \"$env:USERPROFILE\\\\Documents\\\\WindowsPowerShell\\\\Scripts\"\n\n\\# Piping Find-Script output to Install-Script cmdlet\nFind-Script -Repository GalleryINT -Name Required-Script2 | Install-Script -Scope CurrentUser -Verbose\nVERBOSE: Repository details, Name = 'GalleryINT', Location = 'https://customgallery.cloudapp.net/api/v2/'; IsTrusted = 'True'; IsRegistered = 'True'.\nVERBOSE: Performing the operation \"Install-Script\" on target \"Version '2.5' of script 'Required-Script2'\".\nVERBOSE: Using the provider 'PowerShellGet' for searching packages.\nVERBOSE: Using the specified source names : 'GalleryINT'.\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\nVERBOSE: The specified Location is 'https://customgallery.cloudapp.net/api/v2/items/psscript/' and PackageManagementProvider is 'NuGet'.\nVERBOSE: Searching repository 'https://customgallery.cloudapp.net/api/v2/items/psscript/FindPackagesById()?id='Required-Script2'' for ''.\nVERBOSE: Total package yield:'1' for the specified package 'Required-Script2'.\nVERBOSE: Performing the operation \"Install-Script\" on target \"Version '2.5' of script 'Required-Script2'\".\nVERBOSE: The installation scope is specified to be 'CurrentUser'.\nVERBOSE: The specified script will be installed in 'C:\\\\Users\\\\manikb\\\\Documents\\\\WindowsPowerShell\\\\Scripts' and its dependent modules will be installed in\n'C:\\\\Users\\\\manikb\\\\Documents\\\\WindowsPowerShell\\\\Modules'.\nVERBOSE: The specified Location is 'NuGet' and PackageManagementProvider is 'NuGet'.\nVERBOSE: Downloading script 'Required-Script2' with version '2.5' from the repository 'https://customgallery.cloudapp.net/api/v2/items/psscript/'.\nVERBOSE: Script 'Required-Script2' was installed successfully.\n\nGet-InstalledScript Required-Scri\\*\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n\nGet-InstalledScript Required-Script2 | Format-List \\* -Force\nName : Required-Script2\nVersion : 2.5\nType : Script\nDescription : Description for the Required-Script2 script\nAuthor : manikb\nCompanyName :\nCopyright : (c) 2015 Microsoft Corporation. All rights reserved.\nPublishedDate : 10/30/2015 1:25:15 AM\nLicenseUri : http://required-script2.com/license\nProjectUri : http://required-script2.com/\nIconUri : http://required-script2.com/icon\nTags : {Tag1, Tag2, Tag-Required-Script2-2.5, PSScript}\nIncludes : {Function, DscResource, Cmdlet, Workflow...}\nPowerShellGetFormatVersion :\nReleaseNotes : Required-Script2 release notes\nDependencies : {}\nRepositorySourceLocation : https://customgallery.cloudapp.net/api/v2/\nRepository : GalleryINT\nPackageManagementProvider : NuGet\nAdditionalMetadata : {Type, releaseNotes, copyright, PackageManagementProvider...}\nInstalledLocation : C:\\\\Users\\\\manikb\\\\Documents\\\\WindowsPowerShell\\\\Scripts\n\nInstalled script file is immediately available for usage.\n```\n\nYou can also use Get-Command –Name &lt;InstalledScriptFileName&gt; to get it. Two install locations are added to the PATH environment variable on first use of a specified scope.\n```powershell\n$env:Path -split ';'| Where-Object {$\\_} | Select-Object -Last 2\nC:\\\\Program Files\\\\WindowsPowerShell\\\\Scripts\nC:\\\\Users\\\\manikb\\\\Documents\\\\WindowsPowerShell\\\\Scripts\n\nGet-Command Required-Script2\nCommandType Name Version Source\n----------- ---- ------- ------\nExternalScript Required-Script2.ps1 C:\\\\Users\\\\manikb\\\\Documents\\\\WindowsPowerShell\\\\Scripts\\\\Required-Script2.ps1\n\nFind-Script -Repository LocalRepo1 -Name Demo-Script\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n1.0 Demo-Script Script LocalRepo1 Script file description goes here\n\nFind-Script -Repository LocalRepo1 -Name Demo-Script | Install-Script -Scope CurrentUser\nUntrusted repository\nYou are installing the scripts from an untrusted repository. If you trust this repository, change its InstallationPolicy value by running the Set-PSRepository cmdlet. Are you sure you want to install the scripts from 'C:\\\\MyLocalRepo'?\n\\[Y\\] Yes \\[A\\] Yes to All \\[N\\] No \\[L\\] No to All \\[S\\] Suspend \\[?\\] Help (default is \"N\"): Y\n\nGet-InstalledScript Demo-Script\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n1.0 Demo-Script Script LocalRepo1 Script file description goes here\n\nGet-Command Demo-Script\nCommandType Name Version Source\n----------- ---- ------- ------\nExternalScript Demo-Script.ps1 C:\\\\Users\\\\manikb\\\\Documents\\\\WindowsPowerShell\\\\Scripts\\\\Demo-Script.ps1\n\n\\# Using the installed script\nDemo-Script\nDemo-ScriptFunction\nDemo-ScriptWorkflow\n\n\\# Installing a script to default AllUsers scope and with RequiredVersion\nInstall-Script -Repository GalleryINT -Name Required-Script3 -RequiredVersion 2.0\nGet-InstalledScript -Name Required-Script3\n\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.0 Required-Script3 Script GalleryINT Description for the Required-Script3 script\nGet-InstalledScript -Name Required-Script3 | Format-List Name,InstalledLocation -Force\nName : Required-Script3\nInstalledLocation : C:\\\\Program Files\\\\WindowsPowerShell\\\\Scripts\n\nGet-Command Required-Script3\nCommandType Name Version Source\n----------- ---- ------- ------\nExternalScript Required-Script3.ps1 C:\\\\Program Files\\\\WindowsPowerShell\\\\Scripts\\\\Required-Script3.ps1\n\n\\# Installing a script with dependent scripts and modules\nFind-Script -Repository GalleryINT -Name Script-WithDependencies2 -IncludeDependencies\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.0 Script-WithDependencies2 Script GalleryINT Description for the Script-WithDependencies2 script\n2.5 RequiredModule1 Module GalleryINT RequiredModule1 module\n2.5 RequiredModule2 Module GalleryINT RequiredModule2 module\n2.5 RequiredModule3 Module GalleryINT RequiredModule3 module\n2.0 RequiredModule4 Module GalleryINT RequiredModule4 module\n1.5 RequiredModule5 Module GalleryINT RequiredModule5 module\n2.5 Required-Script1 Script GalleryINT Description for the Required-Script1 script\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.5 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n\nGet-InstalledScript\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.0 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n1.0 Demo-Script Script LocalRepo1 Script file description goes here\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\nGet-InstalledModule\nInstall-Script -Repository GalleryINT -Name Script-WithDependencies2 -Scope CurrentUser\nGet-InstalledScript\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.0 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n1.0 Demo-Script Script LocalRepo1 Script file description goes here\n2.5 Required-Script1 Script GalleryINT Description for the Required-Script1 script\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.0 Script-WithDependencies2 Script GalleryINT Description for the Script-WithDependencies2 script\nGet-InstalledModule\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 RequiredModule1 Module GalleryINT RequiredModule1 module\n2.5 RequiredModule2 Module GalleryINT RequiredModule2 module\n2.5 RequiredModule3 Module GalleryINT RequiredModule3 module\n2.0 RequiredModule4 Module GalleryINT RequiredModule4 module\n1.5 RequiredModule5 Module GalleryINT RequiredModule5 module\n\n\\# Contents of Script-WithDependencies2 file.\n&lt;\\#PSScriptInfo\n.VERSION 2.0\n.GUID 90082fa1-0b84-49fb-a00e-0a624fbb6584\n.AUTHOR manikb\n.COMPANYNAME Microsoft Corporation\n.COPYRIGHT (c) 2015 Microsoft Corporation. All rights reserved.\n.TAGS Tag1 Tag2 Tag-Script-WithDependencies2-2.0\n.LICENSEURI http://script-withdependencies2.com/license\n.PROJECTURI http://script-withdependencies2.com/\n.ICONURI http://script-withdependencies2.com/icon\n.EXTERNALMODULEDEPENDENCIES\n.REQUIREDSCRIPTS Required-Script1,Required-Script2,Required-Script3\n.EXTERNALSCRIPTDEPENDENCIES\n.RELEASENOTES\nScript-WithDependencies2 release notes\n\\#&gt;\n**\\#Requires -Module RequiredModule1**\n**\\#Requires -Module @{ModuleName = 'RequiredModule2'; ModuleVersion = '2.0'}**\n**\\#Requires -Module @{RequiredVersion = '2.5'; ModuleName = 'RequiredModule3'}**\n**\\#Requires -Module @{ModuleVersion = '1.1'; ModuleName = 'RequiredModule4'; MaximumVersion = '2.0'}**\n**\\#Requires -Module @{MaximumVersion = '1.5'; ModuleName = 'RequiredModule5'}**\n&lt;\\#\n.DESCRIPTION\nDescription for the Script-WithDependencies2 script\n\\#&gt;\nParam()\nFunction Test-FunctionFromScript\\_Script-WithDependencies2 { Get-Date }\nWorkflow Test-WorkflowFromScript\\_Script-WithDependencies2 { Get-Date }\n```\n\n## Update-Script cmdlet\nUpdate-Script cmdlet lets you to do in-place update of the script files which were installed using Install-Script cmdlet.\n```powershell\nInstall-Script -Name Fabrikam-Script -RequiredVersion 1.0 -Repository GalleryINT -Scope\nGet-InstalledScript -Name Fabrikam-Script\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n1.0 Fabrikam-Script Script GalleryINT Description for the Fabrikam-Script script\n\n\\# Update a specific script to the required version\nUpdate-Script -Name Fabrikam-Script -RequiredVersion 1.5\nGet-InstalledScript -Name Fabrikam-Script\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n1.5 Fabrikam-Script Script GalleryINT Description for the Fabrikam-Script script\n\n\\# Update all installed scripts\nInstall-Script -Name Fabrikam-ServerScript -RequiredVersion 1.0 -Repository GalleryINT -Scope CurrentUser\nGet-InstalledScript\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.0 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n1.0 Demo-Script Script LocalRepo1 Script file description goes here\n1.5 Fabrikam-Script Script GalleryINT Description for the Fabrikam-Script script\n1.0 Fabrikam-ServerScript Script GalleryINT Description for the Fabrikam-ServerScript script\n2.5 Required-Script1 Script GalleryINT Description for the Required-Script1 script\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.0 Script-WithDependencies2 Script GalleryINT Description for the Script-WithDependencies2 script\n\nUpdate-Script\nGet-InstalledScript\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.5 Required-Script3 Script GalleryINT Description for the Required-Script3 script\n1.0 Demo-Script Script LocalRepo1 Script file description goes here\n2.5 Fabrikam-Script Script GalleryINT Description for the Fabrikam-Script script\n2.5 Fabrikam-ServerScript Script GalleryINT Description for the Fabrikam-ServerScript script\n2.5 Required-Script1 Script GalleryINT Description for the Required-Script1 script\n2.5 Required-Script2 Script GalleryINT Description for the Required-Script2 script\n2.0 Script-WithDependencies2 Script GalleryINT Description for the Script-WithDependencies2 script\n```\n\n## Uninstall-Script cmdlet\n```powershell\nUninstall-Script cmdlet lets you to uninstall the installed script files.\nGet-InstalledScript | Uninstall-Script -WhatIf\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.5' of script 'Required-Script3'\".\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '1.0' of script 'Demo-Script'\".\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.5' of script 'Fabrikam-Script'\".\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.5' of script 'Fabrikam-ServerScript'\".\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.5' of script 'Required-Script1'\".\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.5' of script 'Required-Script2'\".\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.0' of script 'Script-WithDependencies2'\".\nUninstall-Script Required-Script1 -WhatIf -RequiredVersion 2.5\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.5' of script 'Required-Script1'\".\nUninstall-Script Required-Script1 -WhatIf -MinimumVersion 2.0 -MaximumVersion 3.0\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.5' of script 'Required-Script1'\".\nGet-InstalledScript -Name Script-WithDependencies2 | Uninstall-Script -WhatIf\nWhat if: Performing the operation \"Uninstall-Script\" on target \"Version '2.0' of script 'Script-WithDependencies2'\".\nGet-InstalledScript -Name Script-WithDependencies2 | Uninstall-Script -Confirm\nConfirm\nAre you sure you want to perform this action?\nPerforming the operation \"Uninstall-Script\" on target \"Version '2.0' of script 'Script-WithDependencies2'\".\n\\[Y\\] Yes \\[A\\] Yes to All \\[N\\] No \\[L\\] No to All \\[S\\] Suspend \\[?\\] Help (default is \"Y\"): N\n\nUninstall-Script Required-Script1 -RequiredVersion 2.5 -Verbose\nVERBOSE: Performing the operation \"Uninstall-Script\" on target \"Version '2.5' of script 'Required-Script1'\".\nVERBOSE: Successfully uninstalled the script 'Required-Script1' from script base 'C:\\\\Users\\\\manikb\\\\Documents\\\\WindowsPowerShell\\\\Scripts'.\n\n\\# Get-InstalledScript should not return the Required-Script1\nGet-InstalledScript Required-Script1\nPackageManagement\\\\Get-Package : No match was found for the specified search criteria and script names 'Required-Script1'.\nAt C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\PowerShellGet\\\\1.0.0.1\\\\PSModule.psm1:3142 char:9\n+ PackageManagement\\\\Get-Package @PSBoundParameters | Microsoft. ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+ CategoryInfo : ObjectNotFound: (Microsoft.Power...lets.GetPackage:GetPackage) \\[Get-Package\\], Exception\n+ FullyQualifiedErrorId : NoMatchFound,Microsoft.PowerShell.PackageManagement.Cmdlets.GetPackage\n```\n\n## New-ScriptFileInfo and Test-ScriptFileInfo cmdlets\nNew-ScriptFileInfo cmdlet lets you to create a new script file with metadata like Version, Guid, Author, and Description, etc. Test-ScriptFileInfo cmdlet lets you to validate and get the script file metadata.\n```powershell\n\\# Create a new script file with minimum required metadata values\nNew-ScriptFileInfo -Path C:\\\\ScriptSharingDemo\\\\Demo-Script.ps1 -Description \"Script file description goes here\"\nGet-Content -Path C:\\\\ScriptSharingDemo\\\\Demo-Script.ps1\n&lt;\\#PSScriptInfo\n.VERSION 1.0\n.GUID 926b47c3-6af2-4b18-b6f5-8b813a9e93ab\n.AUTHOR manikb\n.COMPANYNAME\n.COPYRIGHT\n.TAGS\n.LICENSEURI\n.PROJECTURI\n.ICONURI\n.EXTERNALMODULEDEPENDENCIES\n.REQUIREDSCRIPTS\n.EXTERNALSCRIPTDEPENDENCIES\n.RELEASENOTES\n\\#&gt;\n&lt;\\#\n.DESCRIPTION\nScript file description goes here\n\\#&gt;\nParam()\n\n\\# Validate and get the script metadata\nTest-ScriptFileInfo -Path C:\\\\ScriptSharingDemo\\\\Demo-Script.ps1\nVersion Name Author Description\n------- ---- ------ -----------\n1.0 Demo-Script manikb Script file description goes here\n\n\\# Add function and workflow to the script file\nAdd-Content -Path C:\\\\ScriptSharingDemo\\\\Demo-Script.ps1 -Value @\"\n&gt;&gt;&gt;\n&gt;&gt;&gt; Function Demo-ScriptFunction { 'Demo-ScriptFunction' }\n&gt;&gt;&gt;\n&gt;&gt;&gt; Workflow Demo-ScriptWorkflow { 'Demo-ScriptWorkflow' }\n&gt;&gt;&gt;\n&gt;&gt;&gt; Demo-ScriptFunction\n&gt;&gt;&gt; Demo-ScriptWorkflow\n&gt;&gt;&gt; \"@\n\n\\# Validate and get the script metadata\nTest-ScriptFileInfo -Path C:\\\\ScriptSharingDemo\\\\Demo-Script.ps1\nVersion Name Author Description\n------- ---- ------ -----------\n1.0 Demo-Script manikb Script file description goes here\n\n\\# Create a script file all metadata properties\nNew-ScriptFileInfo -Path 'C:\\\\ScriptSharingDemo\\\\Demo-ScriptWithCompletePSScriptInfo.ps1' \\`\n&gt;&gt;&gt; -Version 1.0 \\`\n&gt;&gt;&gt; -Author 'manikb' \\`\n&gt;&gt;&gt; -Description \"my new script file\" \\`\n&gt;&gt;&gt; -CompanyName \"Microsoft Corporation\" \\`\n&gt;&gt;&gt; -Copyright \"(c) 2015 Microsoft Corporation. All rights reserved.\" \\`\n&gt;&gt;&gt; -Tags @('Tag1', 'Tag2', 'Tag3') \\`\n&gt;&gt;&gt; -ProjectUri 'https://contoso.com' \\`\n&gt;&gt;&gt; -LicenseUri \"https://contoso.com/License\" \\`\n&gt;&gt;&gt; -IconUri 'https://contoso.com/Icon' \\`\n&gt;&gt;&gt; -ReleaseNotes @('contoso script now supports following features',\n&gt;&gt;&gt; 'Feature 1',\n&gt;&gt;&gt; 'Feature 2',\n&gt;&gt;&gt; 'Feature 3',\n&gt;&gt;&gt; 'Feature 4',\n&gt;&gt;&gt; 'Feature 5') \\`\n&gt;&gt;&gt; -RequiredModules @('RequiredModule1',\n&gt;&gt;&gt; @{ModuleName='RequiredModule2';ModuleVersion='1.0'},\n&gt;&gt;&gt; @{ModuleName='RequiredModule3';RequiredVersion='2.0'},\n&gt;&gt;&gt; @{ModuleName = 'RequiredModule4'; ModuleVersion = '0.1'; MaximumVersion = '1.\\*'; },\n&gt;&gt;&gt; @{ModuleName = 'RequiredModule5'; MaximumVersion = '1.\\*'; },\n&gt;&gt;&gt; 'ExternalModule1') \\`\n&gt;&gt;&gt; -ExternalModuleDependencies 'ExternalModule1' \\`\n&gt;&gt;&gt; -RequiredScripts 'Start-WFContosoServer', 'Stop-ContosoServerScript', 'ExternalScript1' \\`\n&gt;&gt;&gt; -ExternalScriptDependencies 'ExternalScript1'\n\n\\# Add function and workflow to the script file\nAdd-Content -Path 'C:\\\\ScriptSharingDemo\\\\Demo-ScriptWithCompletePSScriptInfo.ps1' -Value @\"\n&gt;&gt;&gt;\n&gt;&gt;&gt; Function Demo-ScriptFunction { 'Demo-ScriptFunction' }\n&gt;&gt;&gt;\n&gt;&gt;&gt; Workflow Demo-ScriptWorkflow { 'Demo-ScriptWorkflow' }\n&gt;&gt;&gt;\n&gt;&gt;&gt; Demo-ScriptFunction\n&gt;&gt;&gt; Demo-ScriptWorkflow\n&gt;&gt;&gt; \"@\n\nGet-Content -Path C:\\\\ScriptSharingDemo\\\\Demo-ScriptWithCompletePSScriptInfo.ps1\n&lt;\\#PSScriptInfo\n.VERSION 1.0\n.GUID fe4cc121-f87e-4ddb-8186-ff362e23a935\n.AUTHOR manikb\n.COMPANYNAME Microsoft Corporation\n.COPYRIGHT (c) 2015 Microsoft Corporation. All rights reserved.\n.TAGS Tag1 Tag2 Tag3\n.LICENSEURI https://contoso.com/License\n.PROJECTURI https://contoso.com/\n.ICONURI https://contoso.com/Icon\n.EXTERNALMODULEDEPENDENCIES ExternalModule1\n.REQUIREDSCRIPTS Start-WFContosoServer,Stop-ContosoServerScript,ExternalScript1\n.EXTERNALSCRIPTDEPENDENCIES ExternalScript1\n.RELEASENOTES\ncontoso script now supports following features\nFeature 1\nFeature 2\nFeature 3\nFeature 4\nFeature 5\n\\#&gt;\n\\#Requires -Module RequiredModule1\n\\#Requires -Module @{ModuleName = 'RequiredModule2'; ModuleVersion = '1.0'}\n\\#Requires -Module @{RequiredVersion = '2.0'; ModuleName = 'RequiredModule3'}\n\\#Requires -Module @{ModuleVersion = '0.1'; ModuleName = 'RequiredModule4'; MaximumVersion = '1.\\*'}\n\\#Requires -Module @{MaximumVersion = '1.\\*'; ModuleName = 'RequiredModule5'}\n\\#Requires -Module ExternalModule1\n&lt;\\#\n.DESCRIPTION\nmy new script file\n\\#&gt;\nParam()\nFunction Demo-ScriptFunction { 'Demo-ScriptFunction' }\nWorkflow Demo-ScriptWorkflow { 'Demo-ScriptWorkflow' }\nDemo-ScriptFunction\nDemo-ScriptWorkflow\n\n\\# Validate and get the script metadata\nTest-ScriptFileInfo C:\\\\ScriptSharingDemo\\\\Demo-ScriptWithCompletePSScriptInfo.ps1 | Format-List \\* -Force\nName : Demo-ScriptWithCompletePSScriptInfo\nVersion : 1.0\nGuid : fe4cc121-f87e-4ddb-8186-ff362e23a935\nPath : C:\\\\ScriptSharingDemo\\\\Demo-ScriptWithCompletePSScriptInfo.ps1\nScriptBase : C:\\\\ScriptSharingDemo\nDescription : my new script file\nAuthor : manikb\nCompanyName : Microsoft Corporation\nCopyright : (c) 2015 Microsoft Corporation. All rights reserved.\nTags : {Tag1, Tag2, Tag3}\nReleaseNotes : {contoso script now supports following features, Feature 1, Feature 2, Feature 3...}\nRequiredModules : {RequiredModule1, @{ ModuleName = 'RequiredModule2'; ModuleVersion = '1.0' }, @{ ModuleName = 'RequiredModule3'; RequiredVersion = '2.0' }, @{ ModuleName = 'RequiredModule4'; ModuleVersion = '0.1';\nMaximumVersion = '1.\\*' }...}\nExternalModuleDependencies : ExternalModule1\nRequiredScripts : {Start-WFContosoServer, Stop-ContosoServerScript, ExternalScript1}\nExternalScriptDependencies : ExternalScript1\nLicenseUri : https://contoso.com/License\nProjectUri : https://contoso.com/\nIconUri : https://contoso.com/Icon\nDefinedCommands : {Demo-ScriptFunction, Demo-ScriptWorkflow}\nDefinedFunctions : Demo-ScriptFunction\nDefinedWorkflows : Demo-ScriptWorkflow\n```\n\n## Update-ScriptFileInfo cmdlet\nUpdate-ScriptFileInfo cmdlet lets you to update the existing script file metadata.\n```powershell\n\\# Use Update-ScriptFileInfo cmdlet to update the script metadata\nUpdate-ScriptFileInfo -Path C:\\\\ScriptSharingDemo\\\\Demo-ScriptWithCompletePSScriptInfo.ps1 -Version 2.0\nTest-ScriptFileInfo C:\\\\ScriptSharingDemo\\\\Demo-ScriptWithCompletePSScriptInfo.ps1\nVersion Name Author Description\n------- ---- ------ -----------\n2.0 Demo-ScriptWithComplet... manikb my new script file\n```\n\n## Register-PSRepository and Set-PSRepository cmdlets with script sharing support\nUse Register-PSRepository/Set-PSRepository cmdlets to add the **ScriptSourceLocation** and **ScriptPublishLocation** to the PSRepository.\n```powershell\n\\# Register an GalleryINT repository with Scripts and Modules support\nRegister-PSRepository -Name GalleryINT \\`\n&gt;&gt;&gt; -SourceLocation https://customgallery.cloudapp.net \\`\n&gt;&gt;&gt; -InstallationPolicy Trusted \\`\n&gt;&gt;&gt; -Verbose\nNuGet provider is required to continue\nPowerShellGet requires NuGet provider version '2.8.5.201' or newer to interact with NuGet-based repositories. The NuGet provider must be available in 'C:\\\\Program\nFiles\\\\PackageManagement\\\\ProviderAssemblies' or 'C:\\\\Users\\\\manikb\\\\AppData\\\\Local\\\\PackageManagement\\\\ProviderAssemblies'. You can also install the NuGet provider by running\n'Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force'. Do you want PowerShellGet to install and import the NuGet provider now?\n\\[Y\\] Yes \\[N\\] No \\[S\\] Suspend \\[?\\] Help (default is \"Y\"): Y\nVERBOSE: Installing NuGet provider.\nVERBOSE: The specified assembly 'C:\\\\Program Files\\\\PackageManagement\\\\ProviderAssemblies\\\\nuget-anycpu.exe' is installed at top level directory. However it is recommended that the assemblies\nshould be installed under its ProviderName\\\\Version folder.\nVERBOSE: Installing the package 'https://oneget.org/nuget-2.8.5.201.package.swidtag'.\nVERBOSE: Installed the package 'nuget' to 'C:\\\\Program Files\\\\PackageManagement\\\\ProviderAssemblies\\\\nuget\\\\2.8.5.201\\\\Microsoft.PackageManagement.NuGetProvider.dll'.\nVERBOSE: The provider 'NuGet' has already been imported. Trying to import it again.\nVERBOSE: Importing package provider 'NuGet'.\nVERBOSE: Performing the operation \"Register Module Repository\" on target \"Module Repository 'GalleryINT' (https://customgallery.cloudapp.net/) in provider 'PowerShellGet'\".\nVERBOSE: User did not specify the PackageManagement provider name, trying with the provider name 'NuGet'.\nVERBOSE: Successfully registered the repository 'GalleryINT' with source location 'https://customgallery.cloudapp.net/api/v2/'.\nVERBOSE: Repository details, Name = 'GalleryINT', Location = 'https://customgallery.cloudapp.net/api/v2/'; IsTrusted = 'True'; IsRegistered = 'True'.\n\n\\# Get the registered repository details\nGet-PSRepository -Name GalleryINT\nName PackageManagementProvider InstallationPolicy SourceLocation\n---- ------------------------- ------------------ --------------\nGalleryINT NuGet Trusted https://customgallery.cloudapp.net/api/v2/\nGet-PSRepository -Name GalleryINT | Format-List \\* -Force\nName : GalleryINT\nSourceLocation : https://customgallery.cloudapp.net/api/v2/\nTrusted : True\nRegistered : True\nInstallationPolicy : Trusted\nPackageManagementProvider : NuGet\nPublishLocation : https://customgallery.cloudapp.net/api/v2/package/\nScriptSourceLocation : https://customgallery.cloudapp.net/api/v2/items/psscript/\nScriptPublishLocation : https://customgallery.cloudapp.net/api/v2/package/\nProviderOptions : {}\n\n\\# Add script sharing locations to an existing PSRepository using Set-PSRepository object.  Set-PSRepository -Name MyGallery \\`\n&gt;&gt;&gt; -ScriptSourceLocation https://MyGallery.com/api/v2/items/psscript/ \\`\n&gt;&gt;&gt; -ScriptPublishLocation https://MyGallery.com/api/v2/package/\nGet-PSRepository -Name GalleryINT | Format-List \\* -Force\nName : GalleryINT\nSourceLocation : https://MyGallery.com/api/v2/\nTrusted : True\nRegistered : True\nInstallationPolicy : Trusted\nPackageManagementProvider : NuGet\nPublishLocation : https://MyGallery.com/api/v2/package/\nScriptSourceLocation : https://MyGallery.com/api/v2/items/psscript/\nScriptPublishLocation : https://MyGallery.com/api/v2/package/\nProviderOptions : {}\n```\n\n## Publish-Script cmdlet\nPublish-Script cmdlet lets you to publish your script file with valid metadata like Version, Guid, Author, and Description, etc.\n```powershell\n\\# Publish the really basic script file with required metadata\nPublish-Script -Path C:\\\\ScriptSharingDemo\\\\Demo-Script.ps1 -Repository GalleryINT -NuGetApiKey cad91af7-a49c-4026-9570-a4c16564e785 -Verbose\nNuGet.exe is required to continue\nPowerShellGet requires NuGet.exe to publish an item to the NuGet-based repositories. NuGet.exe must be available under one of the paths specified in PATH environment variable value. Do you\nwant PowerShellGet to install NuGet.exe now?\n\\[Y\\] Yes \\[N\\] No \\[S\\] Suspend \\[?\\] Help (default is \"Y\"): Y\nVERBOSE: Installing NuGet.exe.\nVERBOSE: GET http://go.microsoft.com/fwlink/?LinkID=690216&clcid=0x409 with 0-byte payload\nVERBOSE: received 1686528-byte response of content type application/octet-stream\nVERBOSE: Performing the operation \"Publish-Script\" on target \"Version '1.0' of script 'Demo-Script'\".\nVERBOSE: Successfully published script 'Demo-Script' to the publish location https://customgallery.cloudapp.net/api/v2/package/'. Please allow few minutes for 'Demo-Script' to show up in the search results.\n\nFind-Script -Repository GalleryINT -Name Demo-Script\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n1.0 Demo-Script Script GalleryINT Script file description goes here\n\nFind-Script -Repository GalleryINT -Name Demo-Script | Format-List \\* -Force\nName : Demo-Script\nVersion : 1.0\nType : Script\nDescription : Script file description goes here\nAuthor : manikb\nCompanyName : manikb\nCopyright :\nPublishedDate : 11/16/2015 6:46:28 PM\nLicenseUri :\nProjectUri :\nIconUri :\nTags : {PSScript}\nIncludes : {Function, DscResource, Cmdlet, Workflow...}\nPowerShellGetFormatVersion :\nReleaseNotes :\nDependencies : {}\nRepositorySourceLocation : https://customgallery.cloudapp.net/api/v2/\nRepository : GalleryINT\nPackageManagementProvider : NuGet\nAdditionalMetadata : {description, developmentDependency, tags, PackageManagementProvider...}\n```\n\n"}