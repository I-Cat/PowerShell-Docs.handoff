{"nodes":[{"pos":[105,126],"content":"powershell,cmdlet,jea","needQuote":true,"nodes":[{"content":"powershell,cmdlet,jea","pos":[0,21]}]},{"pos":[156,169],"content":"prerequisites","needQuote":true,"nodes":[{"content":"prerequisites","pos":[0,13]}]},{"content":"Prerequisites","pos":[204,217]},{"content":"Initial State","pos":[222,235]},{"content":"Before starting this section, please ensure the following:","pos":[236,294]},{"content":"JEA is available on your system.","pos":[299,331]},{"content":"Check out the <bpt id=\"p1\">[</bpt>README<ept id=\"p1\">](./README.md)</ept> for the current supported operating systems and required downloads.","pos":[332,435],"source":" Check out the [README](./README.md) for the current supported operating systems and required downloads."},{"content":"You have administrative rights on the computer where you are trying out JEA.","pos":[439,515]},{"content":"The computer is domain joined.","pos":[519,549]},{"content":"See the <bpt id=\"p1\">[</bpt>Creating a Domain Controller<ept id=\"p1\">](#creating-a-domain-controller)</ept> section to quickly set up a new domain on a server if you don't already have one.","pos":[550,701],"source":"\nSee the [Creating a Domain Controller](#creating-a-domain-controller) section to quickly set up a new domain on a server if you don't already have one."},{"content":"Enable PowerShell Remoting","pos":[706,732]},{"content":"Management with JEA occurs through PowerShell Remoting.","pos":[733,788]},{"content":"Run the following in an Administrator PowerShell window to ensure that this is enabled and configured properly:","pos":[789,900],"source":"\nRun the following in an Administrator PowerShell window to ensure that this is enabled and configured properly:"},{"pos":[939,1093],"content":"If you are unfamiliar with PowerShell remoting, it would be a good idea to run <ph id=\"ph1\">`Get-Help about_Remote`</ph> to learn about this important foundational concept.","source":"If you are unfamiliar with PowerShell remoting, it would be a good idea to run `Get-Help about_Remote` to learn about this important foundational concept."},{"content":"Identify Your Users or Groups","pos":[1098,1127]},{"content":"To show JEA in action, you need to identify the non-administrator users and groups you are going to use throughout this guide.","pos":[1128,1254]},{"content":"If you're using an existing domain, please identify or create some unprivileged users and groups.","pos":[1256,1353]},{"content":"You will give these non-administrators access to JEA.","pos":[1354,1407],"source":"\nYou will give these non-administrators access to JEA."},{"content":"Anytime you see the <ph id=\"ph1\">`$NonAdministrator`</ph> variable in a top of a script, assign it to your selected non-administrator users or groups.","pos":[1408,1540],"source":"\nAnytime you see the `$NonAdministrator` variable in a top of a script, assign it to your selected non-administrator users or groups."},{"content":"If you created a new domain from scratch, it's much easier.","pos":[1542,1601]},{"content":"Please use the <bpt id=\"p1\">[</bpt>Set Up Users and Groups<ept id=\"p1\">](creating-a-domain-controller.md#set-up-users-and-groups)</ept> section in the appendix to create a non-administrator users and groups.","pos":[1602,1771],"source":"\nPlease use the [Set Up Users and Groups](creating-a-domain-controller.md#set-up-users-and-groups) section in the appendix to create a non-administrator users and groups."},{"content":"The default values of <ph id=\"ph1\">`$NonAdministrator`</ph> will be the groups created in that section.","pos":[1772,1857],"source":"\nThe default values of `$NonAdministrator` will be the groups created in that section."},{"content":"Set Up Maintenance Role Capability File","pos":[1862,1901]},{"content":"Run the following commands in PowerShell to create the demo Role Capability file we will be using for the next section.","pos":[1902,2021]},{"content":"Later in this guide, you will learn about what this file does.","pos":[2022,2084],"source":"\nLater in this guide, you will learn about what this file does."},{"content":"Create and Register Demo Session Configuration File","pos":[2967,3018]},{"content":"Run the following commands to create and register the demo Session Configuration file we will be using for the next section.","pos":[3019,3143]},{"content":"Later in this guide, you will learn about what this file does.","pos":[3144,3206],"source":"\nLater in this guide, you will learn about what this file does."},{"content":"Enable PowerShell Module Logging (Optional)","pos":[4511,4554]},{"content":"The following steps enable logging for all PowerShell actions on your system.","pos":[4555,4632]},{"content":"You don't need to enable this for JEA to work, but it will be useful in the <bpt id=\"p1\">[</bpt>Reporting on JEA<ept id=\"p1\">](reporting-on-jea.md)</ept> section.","pos":[4633,4757],"source":"\nYou don't need to enable this for JEA to work, but it will be useful in the [Reporting on JEA](reporting-on-jea.md) section."},{"content":"Open the Local Group Policy Editor","pos":[4762,4796]},{"content":"Navigate to \"Computer Configuration\\Administrative Templates\\Windows Components\\Windows PowerShell\"","pos":[4800,4899]},{"content":"Double Click on \"Turn on Module Logging\"","pos":[4903,4943]},{"content":"Click \"Enabled\"","pos":[4947,4962]},{"content":"In the Options section, click on \"Show\" next to Module Names","pos":[4966,5026]},{"content":"Type \"\\*\" in the pop up window.","pos":[5030,5061]},{"content":"This means PowerShell will log commands from all modules.","pos":[5062,5119]},{"content":"Click OK and apply the policy","pos":[5123,5152]},{"content":"Note: you can also enable system-wide PowerShell transcription through Group Policy.","pos":[5154,5238]},{"pos":[5240,5360],"content":"<bpt id=\"p1\">**</bpt>Congratulations, you have now configured your computer with the demo endpoint and are ready to get started with JEA!<ept id=\"p1\">**</ept>","source":"**Congratulations, you have now configured your computer with the demo endpoint and are ready to get started with JEA!**"}],"content":"---\ndescription:  \nmanager:  dongill\nms.topic:  article\nauthor:  jpjofre\nms.prod:  powershell\nkeywords:  powershell,cmdlet,jea\nms.date:  2016-06-22\ntitle:  prerequisites\nms.technology:  powershell\n---\n\n# Prerequisites\n\n## Initial State\nBefore starting this section, please ensure the following:\n\n1. JEA is available on your system. Check out the [README](./README.md) for the current supported operating systems and required downloads.\n2. You have administrative rights on the computer where you are trying out JEA.\n3. The computer is domain joined.\nSee the [Creating a Domain Controller](#creating-a-domain-controller) section to quickly set up a new domain on a server if you don't already have one.\n\n## Enable PowerShell Remoting\nManagement with JEA occurs through PowerShell Remoting.\nRun the following in an Administrator PowerShell window to ensure that this is enabled and configured properly:\n\n```PowerShell\nEnable-PSRemoting\n```\n\nIf you are unfamiliar with PowerShell remoting, it would be a good idea to run `Get-Help about_Remote` to learn about this important foundational concept.\n\n## Identify Your Users or Groups\nTo show JEA in action, you need to identify the non-administrator users and groups you are going to use throughout this guide.\n\nIf you're using an existing domain, please identify or create some unprivileged users and groups.\nYou will give these non-administrators access to JEA.\nAnytime you see the `$NonAdministrator` variable in a top of a script, assign it to your selected non-administrator users or groups.\n\nIf you created a new domain from scratch, it's much easier.\nPlease use the [Set Up Users and Groups](creating-a-domain-controller.md#set-up-users-and-groups) section in the appendix to create a non-administrator users and groups.\nThe default values of `$NonAdministrator` will be the groups created in that section.\n\n## Set Up Maintenance Role Capability File\nRun the following commands in PowerShell to create the demo Role Capability file we will be using for the next section.\nLater in this guide, you will learn about what this file does.\n\n```PowerShell\n# Fields in the role capability\n$MaintenanceRoleCapabilityCreationParams = @{\n    Author = 'Contoso Admin'\n    CompanyName = 'Contoso'\n    VisibleCmdlets = 'Restart-Service'\n    FunctionDefinitions =\n            @{ Name = 'Get-UserInfo'; ScriptBlock = { $PSSenderInfo } }\n}\n\n# Create the demo module, which will contain the maintenance Role Capability File\nNew-Item -Path \"$env:ProgramFiles\\WindowsPowerShell\\Modules\\Demo_Module\" -ItemType Directory\nNew-ModuleManifest -Path \"$env:ProgramFiles\\WindowsPowerShell\\Modules\\Demo_Module\\Demo_Module.psd1\"\nNew-Item -Path \"$env:ProgramFiles\\WindowsPowerShell\\Modules\\Demo_Module\\RoleCapabilities\" -ItemType Directory\n\n# Create the Role Capability file\nNew-PSRoleCapabilityFile -Path \"$env:ProgramFiles\\WindowsPowerShell\\Modules\\Demo_Module\\RoleCapabilities\\Maintenance.psrc\" @MaintenanceRoleCapabilityCreationParams\n```\n\n## Create and Register Demo Session Configuration File\nRun the following commands to create and register the demo Session Configuration file we will be using for the next section.\nLater in this guide, you will learn about what this file does.\n\n```PowerShell\n# Determine domain\n$domain = (Get-CimInstance -ClassName Win32_ComputerSystem).Domain\n\n# Replace with your non-admin group name\n$NonAdministrator = \"$domain\\JEA_NonAdmin_Operator\"\n\n# Specify the settings for this JEA endpoint\n# Note: You will not be able to use a virtual account if you are using WMF 5.0 on Windows 7 or Windows Server 2008 R2\n$JEAConfigParams = @{\n    SessionType = 'RestrictedRemoteServer'\n    RunAsVirtualAccount = $true\n    RoleDefinitions = @{\n        $NonAdministrator = @{ RoleCapabilities = 'Maintenance' }\n    }\n    TranscriptDirectory = \"$env:ProgramData\\JEAConfiguration\\Transcripts\"\n}\n\n# Set up a folder for the Session Configuration files\nif (-not (Test-Path \"$env:ProgramData\\JEAConfiguration\"))\n{\n    New-Item -Path \"$env:ProgramData\\JEAConfiguration\" -ItemType Directory\n}\n\n# Specify the name of the JEA endpoint\n$sessionName = 'JEA_Demo'\n\nif (Get-PSSessionConfiguration -Name $sessionName -ErrorAction SilentlyContinue)\n{\n    Unregister-PSSessionConfiguration -Name $sessionName -ErrorAction Stop\n}\n\nNew-PSSessionConfigurationFile -Path \"$env:ProgramData\\JEAConfiguration\\JEADemo.pssc\" @JEAConfigParams\n\n# Register the session configuration\nRegister-PSSessionConfiguration -Name $sessionName -Path \"$env:ProgramData\\JEAConfiguration\\JEADemo.pssc\"\n```\n\n## Enable PowerShell Module Logging (Optional)\nThe following steps enable logging for all PowerShell actions on your system.\nYou don't need to enable this for JEA to work, but it will be useful in the [Reporting on JEA](reporting-on-jea.md) section.\n\n1. Open the Local Group Policy Editor\n2. Navigate to \"Computer Configuration\\Administrative Templates\\Windows Components\\Windows PowerShell\"\n3. Double Click on \"Turn on Module Logging\"\n4. Click \"Enabled\"\n5. In the Options section, click on \"Show\" next to Module Names\n6. Type \"\\*\" in the pop up window. This means PowerShell will log commands from all modules.\n7. Click OK and apply the policy\n\nNote: you can also enable system-wide PowerShell transcription through Group Policy.\n\n**Congratulations, you have now configured your computer with the demo endpoint and are ready to get started with JEA!**\n\n"}