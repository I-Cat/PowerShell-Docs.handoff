{"nodes":[{"content":"Install-Module","pos":[2,16]},{"content":"Installs the PowerShell modules from online repositories to the local computer.","pos":[18,97]},{"content":"Description","pos":[102,113]},{"content":"Install-Module cmdlet downloads one or more modules from an online gallery, validates and installs them on the local computer to the specified installation scope.","pos":[115,277]},{"content":"The Install-Module cmdlet gets one or more modules that meet specified criteria from an online gallery, verifies that search results are valid modules, and copies module folders to the installation location.","pos":[279,486]},{"content":"When no scope is defined, or when the value of the Scope parameter is AllUsers, the module is installed to %systemdrive%:\\Program Files\\WindowsPowerShell\\Modules.","pos":[488,650]},{"content":"When the value of Scope is CurrentUser, the module is installed to $home\\Documents\\WindowsPowerShell\\Modules.","pos":[651,760]},{"content":"You can filter your results based on minimum and exact versions of specified modules.","pos":[762,847]},{"content":"Side-by-side version support on Windows PowerShell 5.0 or newer","pos":[851,914]},{"content":"Module dependency installation support","pos":[917,955]},{"pos":[958,1063],"content":"<bpt id=\"p1\">**</bpt>Untrusted prompt:<ept id=\"p1\">**</ept>User acceptance is required for installing the modules from an untrusted repository.","source":"**Untrusted prompt:**User acceptance is required for installing the modules from an untrusted repository."},{"content":"-Force reinstalls the installed module","pos":[1066,1104]},{"content":"RequiredVersion installs the specified version in SxS with existing versions on PowerShell version 5.0 or newer.","pos":[1107,1219]},{"content":"Scope","pos":[1225,1230]},{"content":"Specifies the installation scope of the module.","pos":[1231,1278]},{"content":"The acceptable values for this parameter are: AllUsers and CurrentUser.","pos":[1279,1350]},{"content":"The default installation scope is AllUsers.","pos":[1352,1395]},{"content":"The AllUsers scope lets modules be installed in a location that is accessible to all users of the computer, that is, \"$env:SystemDrive\\Program Files\\WindowsPowerShell\\Modules\".","pos":[1397,1573]},{"content":"The CurrentUser scope lets modules be installed only to \"$home\\Documents\\WindowsPowerShell\\Modules\", so that the module is available only to the current user.","pos":[1575,1733]},{"content":"Notes","pos":[1738,1743]},{"content":"This cmdlet runs on Windows PowerShell 3.0 or later releases of Windows PowerShell, on Windows 7 or Windows 2008 R2 and later releases of Windows.","pos":[1745,1891]},{"content":"If an installed module cannot be imported (that is, if it does not have a .psm1, .psd1, or .dll of the same name within the folder), installation fails unless you add the Force parameter to your command.","pos":[1893,2096]},{"content":"If a version of the module on the computer matches the value specified for the Name parameter, and you have not added the MinimumVersion or RequiredVersion parameter, Install-Module silently continues without installing that module.","pos":[2098,2330]},{"content":"If the MinimumVersion or RequiredVersion parameters are specified, and the existing module does not match the values in that parameter, then an error occurs.","pos":[2331,2488]},{"content":"To be more specific: if the version of the currently-installed module is either lower than the value of the MinimumVersion parameter, or not equal to the value of the RequiredVersion parameter, an error occurs.","pos":[2489,2699]},{"content":"If the version of the installed module is greater than the value of the MinimumVersion parameter, or equal to the value of the RequiredVersion parameter, Install-Module silently continues without installing that module.","pos":[2700,2919]},{"content":"Install-Module returns an error if no module exists in the online gallery that matches the specified name.","pos":[2921,3027]},{"content":"To install multiple modules, specify an array of the module names, separated by commas.","pos":[3029,3116]},{"content":"You cannot add MinimumVersion or RequiredVersion if you specify multiple module names.","pos":[3117,3203]},{"content":"By default, modules are installed to the Program Files folder, to prevent confusion when you are installing Windows PowerShell Desired State Configuration (DSC) resources.You can pipe multiple PSGetItemInfo objects to Install-Module; this is another way of specifying multiple modules to install in a single command.","pos":[3205,3521]},{"content":"To help prevent running modules that contain malicious code, installed modules are not automatically imported by installation.","pos":[3523,3649]},{"content":"As a security best practice, evaluate module code before running any cmdlets or functions in a module for the first time.","pos":[3650,3771]},{"content":"Cmdlet syntax","pos":[3777,3790]},{"content":"Cmdlet online help reference","pos":[3876,3904]},{"pos":[3906,3969],"content":"<bpt id=\"p1\">[</bpt>Install-Module<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=398573)</ept>","source":"[Install-Module](http://go.microsoft.com/fwlink/?LinkID=398573)"},{"content":"Example commands","pos":[3974,3990]},{"content":"Install-Module cmdlet in pipeline operations","pos":[5458,5502]},{"content":"Side-by-Side Version Support on PowerShell 5.0 or newer","pos":[6682,6737]},{"content":"PowerShellGet supports the side-by-side (SxS) module version support in Install-Module, Update-Module, and Publish-Module cmdlets that run in Windows PowerShell 5.0 or newer.","pos":[6739,6913]},{"content":"Install-Module examples","pos":[6919,6942]},{"content":"Install module with its dependencies","pos":[8295,8331]},{"content":"Error scenarios","pos":[13790,13805]}],"content":"# Install-Module\n\nInstalls the PowerShell modules from online repositories to the local computer.\n\n## Description\n\nInstall-Module cmdlet downloads one or more modules from an online gallery, validates and installs them on the local computer to the specified installation scope.\n\nThe Install-Module cmdlet gets one or more modules that meet specified criteria from an online gallery, verifies that search results are valid modules, and copies module folders to the installation location.\n\nWhen no scope is defined, or when the value of the Scope parameter is AllUsers, the module is installed to %systemdrive%:\\Program Files\\WindowsPowerShell\\Modules. When the value of Scope is CurrentUser, the module is installed to $home\\Documents\\WindowsPowerShell\\Modules.\n\nYou can filter your results based on minimum and exact versions of specified modules.\n\n- Side-by-side version support on Windows PowerShell 5.0 or newer\n- Module dependency installation support\n- **Untrusted prompt:**User acceptance is required for installing the modules from an untrusted repository.\n- -Force reinstalls the installed module\n- RequiredVersion installs the specified version in SxS with existing versions on PowerShell version 5.0 or newer.\n\n### Scope\nSpecifies the installation scope of the module. The acceptable values for this parameter are: AllUsers and CurrentUser.\n\nThe default installation scope is AllUsers.\n\nThe AllUsers scope lets modules be installed in a location that is accessible to all users of the computer, that is, \"$env:SystemDrive\\Program Files\\WindowsPowerShell\\Modules\".\n\nThe CurrentUser scope lets modules be installed only to \"$home\\Documents\\WindowsPowerShell\\Modules\", so that the module is available only to the current user.\n\n## Notes\n\nThis cmdlet runs on Windows PowerShell 3.0 or later releases of Windows PowerShell, on Windows 7 or Windows 2008 R2 and later releases of Windows.\n\nIf an installed module cannot be imported (that is, if it does not have a .psm1, .psd1, or .dll of the same name within the folder), installation fails unless you add the Force parameter to your command.\n\nIf a version of the module on the computer matches the value specified for the Name parameter, and you have not added the MinimumVersion or RequiredVersion parameter, Install-Module silently continues without installing that module. If the MinimumVersion or RequiredVersion parameters are specified, and the existing module does not match the values in that parameter, then an error occurs. To be more specific: if the version of the currently-installed module is either lower than the value of the MinimumVersion parameter, or not equal to the value of the RequiredVersion parameter, an error occurs. If the version of the installed module is greater than the value of the MinimumVersion parameter, or equal to the value of the RequiredVersion parameter, Install-Module silently continues without installing that module.\n\nInstall-Module returns an error if no module exists in the online gallery that matches the specified name.\n\nTo install multiple modules, specify an array of the module names, separated by commas. You cannot add MinimumVersion or RequiredVersion if you specify multiple module names.\n\nBy default, modules are installed to the Program Files folder, to prevent confusion when you are installing Windows PowerShell Desired State Configuration (DSC) resources.You can pipe multiple PSGetItemInfo objects to Install-Module; this is another way of specifying multiple modules to install in a single command.\n\nTo help prevent running modules that contain malicious code, installed modules are not automatically imported by installation. As a security best practice, evaluate module code before running any cmdlets or functions in a module for the first time.\n\n\n## Cmdlet syntax\n```powershell\nGet-Command -Name Install-Module -Module PowerShellGet -Syntax\n```\n\n## Cmdlet online help reference\n\n[Install-Module](http://go.microsoft.com/fwlink/?LinkID=398573)\n\n## Example commands\n\n```powershell\n\n# Install a module by name\nInstall-Module -Name MyDscModule\n\n# Install multiple modules\nInstall-Module ContosoClient,ContosoServer\n\n# Install a module using its minimum version\nInstall-Module -Name ContosoServer -MinimumVersion 1.0\n\n# Install a specific version of a module\nInstall-Module -Name ContosoServer -RequiredVersion 1.1.3\n\n# Install the latest version of a module to $home\\Documents\\WindowsPowerShell\\Modules.\nInstall-Module -Name ContosoServer -Scope CurrentUser\n\n# if a module is already available under $env:PSModulePath, below command fails with 'ModuleAlreadyInstalled,Install-Package,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage'\nInstall-Module ContosoServer -RequiredVersion 1.5\n\n# if a module is already available under $env:PSModulePath, below command fails with 'ModuleAlreadyInstalled,Install-Package,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage'\nInstall-Module ContosoServer -MinimumVersion 2.5\n\n# Install multiple modules from multiple registered repositories\nInstall-Module ContosoClient,ContosoServer -Repository PSGallery, PrivatePSGallery\n\n# Install a module with -WhatIf\nInstall-Module ContosoClient -WhatIf\n\n# Install a module with -Confirm. A prompt will be displayed to confirm the installation.\nInstall-Module ContosoClient -WhatIf\n\n# -Force option reinstalls the installed module\nInstall-Module ContosoClient -Force\n\n# Install a module with dependencies\nInstall-Module -Name \n```\n\n## Install-Module cmdlet in pipeline operations\n\n```powershell\n\n# Find a module and install it\nFind-Module -Name \"MyDSC*\" | Install-Module\n\n# Find a module and install it to the CurrentUser scope\nFind-Module -Name \"MyDSC*\" | Install-Module -Scope CurrentUser\n\n# Find commands by name and install them\n# The first command finds the specified commands in the INT repository, and then uses the pipeline operator to pass them to Install-Module to install them.\n# The second command uses Get-InstalledModule to verify the modules from the prior command are installed.\nFind-Command -Repository \"INT\" -Name Get-ContosoClient,Get-ContosoServer | Install-Module\nGet-InstalledModule\n\n# This command finds the resource named MyResource and passes it to the Install-Module cmdlet by using the pipeline operator. The Install-Module cmdlet installs the module for the resource. \n# If you pipe multiple resources to the Install-Module cmdlet from the same module, Install-Module attempts to install the module only once. \nFind-DscResource -Name \"MyResource\" | Install-Module\nGet-InstalledModule\n\n# Find multiple role capabilities and install them\nFind-RoleCapability -Name MyJeaRole, Maintenance | Install-Module\nGet-InstalledModule\n\n```\n\n## Side-by-Side Version Support on PowerShell 5.0 or newer\n\nPowerShellGet supports the side-by-side (SxS) module version support in Install-Module, Update-Module, and Publish-Module cmdlets that run in Windows PowerShell 5.0 or newer.\n\n### Install-Module examples\n\n```powershell\n# Install a version of the module\nInstall-Module -Name PSScriptAnalyzer -RequiredVersion 1.1.0 -Repository PSGallery\nGet-Module -ListAvailable -Name PSScriptAnalyzer | Format-List Name,Version,ModuleBase\n\nName : PSScriptAnalyzer\nVersion : 1.1.0\nModuleBase : C:\\Program Files\\WindowsPowerShell\\Modules\\PSScriptAnalyzer\\1.1.0\n\n# Install another version of the module in Side-by-Side with already installed version.\nInstall-Module -Name PSScriptAnalyzer -RequiredVersion 1.1.1 -Repository PSGallery\nGet-Module -ListAvailable -Name PSScriptAnalyzer | Format-List Name,Version,ModuleBase\n\nName       : PSScriptAnalyzer \nVersion    : 1.1.1\nModuleBase : C:\\Program Files\\WindowsPowerShell\\Modules\\PSScriptAnalyzer\\1.1.1\nName       : PSScriptAnalyzer\nVersion    : 1.1.0\nModuleBase : C:\\Program Files\\WindowsPowerShell\\Modules\\PSScriptAnalyzer\\1.1.0\n\n# Get all versions of an installed module\nGet-InstalledModule -Name PSScriptAnalyzer -AllVersions\nVersion    Name                                Repository           Description\n-------    ----                                ----------           -----------\n1.1.0      PSScriptAnalyzer                    PSGallery            PSScriptAnalyzer provides script analysis... \n1.1.1      PSScriptAnalyzer                    PSGallery            PSScriptAnalyzer provides script analysis...\n\n\n```\n\n## Install module with its dependencies\n\n```powershell\n\n# Find a module\nFind-Module -Name TypePx -Repository PSGallery\n\nVersion    Name                                Repository           Description\n-------    ----                                ----------           -----------\n2.0.1.20   TypePx                              PSGallery            The TypePx module adds properties and methods to the m...\n\n# Find a module and its dependencies\nFind-Module -Name TypePx -Repository PSGallery -IncludeDependencies\n\nVersion    Name                                Repository           Description\n-------    ----                                ----------           -----------\n2.0.1.20   TypePx                              PSGallery            The TypePx module adds properties and methods to the m...\n1.0.5.18   SnippetPx                           PSGallery            The SnippetPx module enhances the snippet experience i...\n\n# Discover the dependencies list without adding -IncludeDependencies\n$result = Find-Module -Name TypePx -Repository PSGallery\n$result.Dependencies\n\nName                           Value\n----                           -----\nName                           SnippetPx\nCanonicalId                    powershellget:SnippetPx/#https://www.powershellgallery.com/api/v2/\n\n\n# Now install the module along with its dependencies\nInstall-Module -Name TypePx -Repository PSGallery -Verbose\n\nVERBOSE: Repository details, Name = 'PSGallery', Location = 'https://www.powershellgallery.com/api/v2/'; IsTrusted =\n'False'; IsRegistered = 'True'.\nVERBOSE: Using the provider 'PowerShellGet' for searching packages.\nVERBOSE: Using the specified source names : 'PSGallery'.\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\nVERBOSE: The specified Location is 'https://www.powershellgallery.com/api/v2/' and PackageManagementProvider is\n'NuGet'.\nVERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='TypePx'' for ''.\nVERBOSE: Total package yield:'1' for the specified package 'TypePx'.\nVERBOSE: Performing the operation \"Install-Module\" on target \"Version '2.0.1.20' of module 'TypePx'\".\n\nUntrusted repository\nYou are installing the modules from an untrusted repository. If you trust this repository, change its\nInstallationPolicy value by running the Set-PSRepository cmdlet. Are you sure you want to install the modules from\n'PSGallery'?\n[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is \"N\"): Y\nVERBOSE: The installation scope is specified to be 'AllUsers'.\nVERBOSE: The specified module will be installed in 'C:\\Program Files\\WindowsPowerShell\\Modules'.\nVERBOSE: The specified Location is 'NuGet' and PackageManagementProvider is 'NuGet'.\nVERBOSE: Downloading module 'TypePx' with version '2.0.1.20' from the repository\n'https://www.powershellgallery.com/api/v2/'.\nVERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='TypePx'' for ''.\nVERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='SnippetPx'' for ''.\nVERBOSE: InstallPackage' - name='SnippetPx',\nversion='1.0.5.18',destination='C:\\Users\\manikb\\AppData\\Local\\Temp\\1027042896'\nVERBOSE: DownloadPackage' - name='SnippetPx',\nversion='1.0.5.18',destination='C:\\Users\\manikb\\AppData\\Local\\Temp\\1027042896\\SnippetPx\\SnippetPx.nupkg',\nuri='https://www.powershellgallery.com/api/v2/package/SnippetPx/1.0.5.18'\nVERBOSE: Downloading 'https://www.powershellgallery.com/api/v2/package/SnippetPx/1.0.5.18'.\nVERBOSE: Completed downloading 'https://www.powershellgallery.com/api/v2/package/SnippetPx/1.0.5.18'.\nVERBOSE: Completed downloading 'SnippetPx'.\nVERBOSE: Hash for package 'SnippetPx' does not match hash provided from the server.\nVERBOSE: InstallPackageLocal' - name='SnippetPx',\nversion='1.0.5.18',destination='C:\\Users\\manikb\\AppData\\Local\\Temp\\1027042896'\nVERBOSE: InstallPackage' - name='TypePx',\nversion='2.0.1.20',destination='C:\\Users\\manikb\\AppData\\Local\\Temp\\1027042896'\nVERBOSE: DownloadPackage' - name='TypePx',\nversion='2.0.1.20',destination='C:\\Users\\manikb\\AppData\\Local\\Temp\\1027042896\\TypePx\\TypePx.nupkg',\nuri='https://www.powershellgallery.com/api/v2/package/TypePx/2.0.1.20'\nVERBOSE: Downloading 'https://www.powershellgallery.com/api/v2/package/TypePx/2.0.1.20'.\nVERBOSE: Completed downloading 'https://www.powershellgallery.com/api/v2/package/TypePx/2.0.1.20'.\nVERBOSE: Completed downloading 'TypePx'.\nVERBOSE: Hash for package 'TypePx' does not match hash provided from the server.\nVERBOSE: InstallPackageLocal' - name='TypePx',\nversion='2.0.1.20',destination='C:\\Users\\manikb\\AppData\\Local\\Temp\\1027042896'\nVERBOSE: Installing the dependency module 'SnippetPx' with version '1.0.5.18' for the module 'TypePx'.\nVERBOSE: Module 'SnippetPx' was installed successfully to path 'C:\\Program\nFiles\\WindowsPowerShell\\Modules\\SnippetPx\\1.0.5.18'.\nVERBOSE: Module 'TypePx' was installed successfully to path 'C:\\Program\nFiles\\WindowsPowerShell\\Modules\\TypePx\\2.0.1.20'.\n\n\n# Get the installed modules\nGet-InstalledModule\n\nVersion    Name                                Repository           Description\n-------    ----                                ----------           -----------\n1.0.5.18   SnippetPx                           PSGallery            The SnippetPx module enhances the snippet experience i...\n2.0.1.20   TypePx                              PSGallery            The TypePx module adds properties and methods to the m...\n\n```\n\n## Error scenarios\n\n```powershell\n\n# Below command fails with 'NameShouldNotContainWildcardCharacters,Install-Module'\nInstall-Module ContosoServe*\n\n# Below command fails with 'VersionRangeAndRequiredVersionCannotBeSpecifiedTogether,Install-Module'\nInstall-Module ContosoServer -MinimumVersion 1.0 -RequiredVersion 5.0\n\n# Below command fails with 'VersionParametersAreAllowedOnlyWithSingleName,Install-Module'\nInstall-Module ContosoClient,ContosoServer -RequiredVersion 2.0\n\n# Below command fails with 'VersionParametersAreAllowedOnlyWithSingleName,Install-Module'\nInstall-Module ContosoClient,ContosoServer -MinimumVersion 2.0\n\n```\n"}