{"nodes":[{"pos":[32,71],"content":"ATA Database Management | Microsoft ATA","needQuote":true,"nodes":[{"content":"ATA Database Management | Microsoft ATA","pos":[0,39]}]},{"pos":[85,150],"content":"Procedures to help you move, backup, or restore the ATA database.","needQuote":true,"nodes":[{"content":"Procedures to help you move, backup, or restore the ATA database.","pos":[0,65]}]},{"pos":[467,518],"content":"<bpt id=\"p1\">*</bpt>Applies to: Advanced Threat Analytics version 1.7<ept id=\"p1\">*</ept>","source":"*Applies to: Advanced Threat Analytics version 1.7*"},{"content":"ATA Database Management","pos":[524,547]},{"content":"If you need to move, backup or restore the ATA database, use these procedures for working with MongoDB.","pos":[548,651]},{"content":"Backing up the ATA database","pos":[656,683]},{"pos":[684,785],"content":"Refer to the <bpt id=\"p1\">[</bpt>relevant MongoDB documentation<ept id=\"p1\">](http://docs.mongodb.org/manual/administration/backup/)</ept>.","source":"Refer to the [relevant MongoDB documentation](http://docs.mongodb.org/manual/administration/backup/)."},{"content":"Restoring the ATA database","pos":[790,816]},{"pos":[817,918],"content":"Refer to the <bpt id=\"p1\">[</bpt>relevant MongoDB documentation<ept id=\"p1\">](http://docs.mongodb.org/manual/administration/backup/)</ept>.","source":"Refer to the [relevant MongoDB documentation](http://docs.mongodb.org/manual/administration/backup/)."},{"content":"Moving the ATA database to another drive","pos":[923,963]},{"pos":[969,1033],"content":"Stop the <bpt id=\"p1\">**</bpt>Microsoft Advanced Threat Analytics Center<ept id=\"p1\">**</ept> service.","source":"Stop the **Microsoft Advanced Threat Analytics Center** service."},{"pos":[1039,1068],"content":"Stop the <bpt id=\"p1\">**</bpt>MongoDB<ept id=\"p1\">**</ept> service.","source":"Stop the **MongoDB** service."},{"content":"Open the Mongo configuration file located by default at: C:\\Program Files\\Microsoft Advanced Threat Analytics\\Center\\MongoDB\\bin\\mongod.cfg.","pos":[1074,1214]},{"pos":[1220,1256],"content":"Find the parameter <ph id=\"ph1\">`storage: dbPath`</ph>","source":"Find the parameter `storage: dbPath`"},{"pos":[1262,1331],"content":"Move the folder listed in the <ph id=\"ph1\">`dbPath`</ph> parameter to the new location.","source":"Move the folder listed in the `dbPath` parameter to the new location."},{"pos":[1337,1454],"content":"Change the <ph id=\"ph1\">`dbPath`</ph> parameter inside the mongo configuration file to the new folder path and save and close the file.","source":"Change the `dbPath` parameter inside the mongo configuration file to the new folder path and save and close the file."},{"content":"Modify MongoDB configuration image","pos":[1462,1496]},{"pos":[1533,1563],"content":"Start the <bpt id=\"p1\">**</bpt>MongoDB<ept id=\"p1\">**</ept> service.","source":"Start the **MongoDB** service."},{"pos":[1568,1633],"content":"Start the <bpt id=\"p1\">**</bpt>Microsoft Advanced Threat Analytics Center<ept id=\"p1\">**</ept> service.","source":"Start the **Microsoft Advanced Threat Analytics Center** service."},{"content":"ATA Configuration file","pos":[1638,1660]},{"content":"The configuration of ATA is stored in the \"SystemProfile\" collection in the database.","pos":[1661,1746]},{"content":"This collection is backed up every hour by the ATA Center service to files called: \"SystemProfile_<bpt id=\"p1\">*</bpt>timestamp<ept id=\"p1\">*</ept>.json\".","pos":[1747,1863],"source":"\nThis collection is backed up every hour by the ATA Center service to files called: \"SystemProfile_*timestamp*.json\"."},{"content":"The most recent 10 versions are stored.","pos":[1864,1903]},{"content":"This is located in a subfolder called \"Backup\".","pos":[1904,1951],"source":"\nThis is located in a subfolder called \"Backup\"."},{"content":"In the default ATA installed location it can be found here:  <bpt id=\"p1\">*</bpt>C:\\Program Files\\Microsoft Advanced Threat Analytics\\Center\\Backup\\SystemProfile_<ept id=\"p1\">*</ept>timestamp<bpt id=\"p2\">*</bpt>.json<ept id=\"p2\">*</ept>.","pos":[1952,2113],"source":" In the default ATA installed location it can be found here:  *C:\\Program Files\\Microsoft Advanced Threat Analytics\\Center\\Backup\\SystemProfile_*timestamp*.json*."},{"pos":[2116,2214],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>: It is recommended that you back up this file somewhere when making major changes to ATA.","source":"**Note**: It is recommended that you back up this file somewhere when making major changes to ATA."},{"content":"It is possible to restore all the settings by running the following command:","pos":[2216,2292]},{"content":"See Also","pos":[2403,2411]},{"pos":[2414,2489],"content":"<bpt id=\"p1\">[</bpt>ATA architecture<ept id=\"p1\">](/advanced-threat-analytics/plan-design/ata-architecture)</ept>","source":"[ATA architecture](/advanced-threat-analytics/plan-design/ata-architecture)"},{"pos":[2492,2569],"content":"<bpt id=\"p1\">[</bpt>ATA prerequisites<ept id=\"p1\">](/advanced-threat-analytics/plan-design/ata-prerequisites)</ept>","source":"[ATA prerequisites](/advanced-threat-analytics/plan-design/ata-prerequisites)"},{"pos":[2572,2668],"content":"<bpt id=\"p1\">[</bpt>Check out the ATA forum!<ept id=\"p1\">](https://social.technet.microsoft.com/Forums/security/home?forum=mata)</ept>","source":"[Check out the ATA forum!](https://social.technet.microsoft.com/Forums/security/home?forum=mata)"}],"content":"---\n# required metadata\n\ntitle: ATA Database Management | Microsoft ATA\ndescription: Procedures to help you move, backup, or restore the ATA database.\nkeywords:\nauthor: rkarlin\nmanager: mbaldwin\nms.date: 04/28/2016\nms.topic: article\nms.prod:\nms.service: advanced-threat-analytics\nms.technology:\nms.assetid: 1d27dba8-fb30-4cce-a68a-f0b1df02b977\n\n# optional metadata\n\n#ROBOTS:\n#audience:\n#ms.devlang:\nms.reviewer: bennyl\nms.suite: ems\n#ms.tgt_pltfrm:\n#ms.custom:\n\n---\n\n*Applies to: Advanced Threat Analytics version 1.7*\n\n\n\n# ATA Database Management\nIf you need to move, backup or restore the ATA database, use these procedures for working with MongoDB.\n\n## Backing up the ATA database\nRefer to the [relevant MongoDB documentation](http://docs.mongodb.org/manual/administration/backup/).\n\n## Restoring the ATA database\nRefer to the [relevant MongoDB documentation](http://docs.mongodb.org/manual/administration/backup/).\n\n## Moving the ATA database to another drive\n\n1.  Stop the **Microsoft Advanced Threat Analytics Center** service.\n\n2.  Stop the **MongoDB** service.\n\n3.  Open the Mongo configuration file located by default at: C:\\Program Files\\Microsoft Advanced Threat Analytics\\Center\\MongoDB\\bin\\mongod.cfg.\n\n    Find the parameter `storage: dbPath`\n\n4.  Move the folder listed in the `dbPath` parameter to the new location.\n\n5.  Change the `dbPath` parameter inside the mongo configuration file to the new folder path and save and close the file.\n\n    ![Modify MongoDB configuration image](media/ATA-mongoDB-moveDB.png)\n\n6.  Start the **MongoDB** service.\n\n7. Start the **Microsoft Advanced Threat Analytics Center** service.\n\n## ATA Configuration file\nThe configuration of ATA is stored in the \"SystemProfile\" collection in the database.\nThis collection is backed up every hour by the ATA Center service to files called: \"SystemProfile_*timestamp*.json\". The most recent 10 versions are stored.\nThis is located in a subfolder called \"Backup\". In the default ATA installed location it can be found here:  *C:\\Program Files\\Microsoft Advanced Threat Analytics\\Center\\Backup\\SystemProfile_*timestamp*.json*. \n\n**Note**: It is recommended that you back up this file somewhere when making major changes to ATA.\n\nIt is possible to restore all the settings by running the following command:\n\n`mongoimport.exe --db ATA --collection SystemProfile --file \"<SystemProfile.json backup file>\" --upsert`\n\n## See Also\n- [ATA architecture](/advanced-threat-analytics/plan-design/ata-architecture)\n- [ATA prerequisites](/advanced-threat-analytics/plan-design/ata-prerequisites)\n- [Check out the ATA forum!](https://social.technet.microsoft.com/Forums/security/home?forum=mata)\n\n"}