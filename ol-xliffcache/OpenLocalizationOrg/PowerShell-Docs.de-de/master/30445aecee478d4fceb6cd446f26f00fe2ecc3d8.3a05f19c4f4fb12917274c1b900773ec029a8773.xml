{"nodes":[{"pos":[11,50],"content":"Install and configure WMF 5.1 (Preview)","needQuote":true,"nodes":[{"content":"Install and configure WMF 5.1 (Preview)","pos":[0,39]}]},{"pos":[83,103],"content":"PowerShell, DSC, WMF","needQuote":true,"nodes":[{"content":"PowerShell, DSC, WMF","pos":[0,20]}]},{"content":"Install and Configure WMF 5.1 (Preview)","pos":[224,263]},{"content":"Install .Net 4.6","pos":[270,286]},{"content":"You must install the .NET Framework 4.6 to use WMF 5.1.","pos":[287,342]},{"content":"This is required to enable the new catalog-signing features, which impacts several areas of module and script loading in WMF 5.1.","pos":[343,473],"source":" \nThis is required to enable the new catalog-signing features, which impacts several areas of module and script loading in WMF 5.1."},{"content":"The <bpt id=\"p1\">[</bpt>.NET Framework 4.6 is available as KB 3045560<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/3045560)</ept>.","pos":[476,576],"source":"The [.NET Framework 4.6 is available as KB 3045560](https://support.microsoft.com/en-us/kb/3045560)."},{"content":"Install instructions are available at the download location.","pos":[577,638],"source":" \nInstall instructions are available at the download location."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> It is a known issue that .NET 4.6 requirement is not detected by the WMF 5.1 Preview installer, so you will be able to install WMF 5.1 Preview before installing .NET 4.6.","pos":[642,822],"source":"**Note:** It is a known issue that .NET 4.6 requirement is not detected by the WMF 5.1 Preview installer, so you will be able to install WMF 5.1 Preview before installing .NET 4.6."},{"content":"Our testing has shown that you can install .NET 4.6 after installing the WMF 5.1 Preview.","pos":[823,913],"source":" \nOur testing has shown that you can install .NET 4.6 after installing the WMF 5.1 Preview."},{"content":"The final version of WMF 5.1 will correctly check this prerequisite requirement before installing.","pos":[914,1013],"source":" \nThe final version of WMF 5.1 will correctly check this prerequisite requirement before installing."},{"content":"Download and install the WMF 5.1 Preview","pos":[1019,1059]},{"content":"Download the WMF 5.1 package for the operating system and architecture you wish to install it on:","pos":[1061,1158]},{"content":"Operating System","pos":[1162,1178]},{"content":"Prerequisites","pos":[1187,1200]},{"content":"Package Links","pos":[1203,1216]},{"content":"Windows Server 2012 R2","pos":[1304,1326]},{"pos":[1329,1397],"content":"<bpt id=\"p1\">[</bpt>.NET Framework 4.6<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/3045560)</ept>","source":"[.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560)"},{"pos":[1400,1483],"content":"<bpt id=\"p1\">[</bpt>Win8.1AndW2K12R2-KB3156422-x64.msu<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=823586)</ept>","source":"[Win8.1AndW2K12R2-KB3156422-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823586)"},{"content":"Windows Server 2012","pos":[1487,1506]},{"pos":[1512,1580],"content":"<bpt id=\"p1\">[</bpt>.NET Framework 4.6<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/3045560)</ept>","source":"[.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560)"},{"pos":[1583,1655],"content":"<bpt id=\"p1\">[</bpt>W2K12-KB3156423-x64.msu<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=823587)</ept>","source":"[W2K12-KB3156423-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823587)"},{"content":"Windows Server 2008 R2","pos":[1659,1681]},{"content":"<bpt id=\"p1\">[</bpt>.NET Framework 4.6<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/3045560)</ept>","pos":[1684,1752],"source":"[.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560)"},{"content":"<bpt id=\"p1\">[</bpt>WMF 4.0<ept id=\"p1\">](http://www.microsoft.com/en-us/download/details.aspx?id=40855)</ept>","pos":[1759,1831],"source":"[WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855)"},{"content":"Security update for <bpt id=\"p1\">[</bpt>SHA-2 Code Signing<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/security/3033929)</ept>","pos":[1838,1940],"source":" Security update for [SHA-2 Code Signing](https://technet.microsoft.com/en-us/library/security/3033929)"},{"pos":[1943,2023],"content":"<bpt id=\"p1\">[</bpt>Win7AndW2K8R2-KB3156424-x64.msu<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=823588)</ept>","source":"[Win7AndW2K8R2-KB3156424-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823588)"},{"content":"Windows 8.1","pos":[2028,2039]},{"pos":[2053,2121],"content":"<bpt id=\"p1\">[</bpt>.NET Framework 4.6<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/3045560)</ept>","source":"[.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560)"},{"content":"<bpt id=\"p1\">**</bpt>x64:<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>Win8.1AndW2K12R2-KB3156422-x64.msu<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkID=823586)</ept>","pos":[2124,2216],"source":"**x64:** [Win8.1AndW2K12R2-KB3156422-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823586)"},{"content":"<bpt id=\"p1\">**</bpt>x86:<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>Win8.1-KB3156422-x86.msu<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkID=823589)</ept>","pos":[2223,2305],"source":"**x86:** [Win8.1-KB3156422-x86.msu](http://go.microsoft.com/fwlink/?LinkID=823589)"},{"content":"Windows 7 SP1","pos":[2310,2323]},{"content":"<bpt id=\"p1\">[</bpt>.NET Framework 4.6<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/3045560)</ept>","pos":[2335,2403],"source":"[.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560)"},{"content":"<bpt id=\"p1\">[</bpt>WMF 4.0<ept id=\"p1\">](http://www.microsoft.com/en-us/download/details.aspx?id=40855)</ept>","pos":[2410,2482],"source":"[WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855)"},{"content":"Security update for <bpt id=\"p1\">[</bpt>SHA-2 Code Signing<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/security/3033929)</ept>","pos":[2489,2591],"source":" Security update for [SHA-2 Code Signing](https://technet.microsoft.com/en-us/library/security/3033929)"},{"content":"<bpt id=\"p1\">**</bpt>x64:<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>Win7AndW2K8R2-KB3156424-x64.msu<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkID=823588)</ept>","pos":[2594,2683],"source":"**x64:** [Win7AndW2K8R2-KB3156424-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823588)"},{"content":"<bpt id=\"p1\">**</bpt>x86:<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>Win7-KB3156424-x86.msu<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkID=823590)</ept>","pos":[2690,2770],"source":"**x86:** [Win7-KB3156424-x86.msu](http://go.microsoft.com/fwlink/?LinkID=823590)"},{"content":"Install WMF 5.1 from Windows Explorer (or File Explorer in Windows Server 2012 R2 or Windows 8.1)","pos":[2778,2875]},{"content":"Navigate to the folder into which you downloaded the MSU file.","pos":[2880,2942]},{"content":"Double-click the MSU to run it.","pos":[2947,2978]},{"content":"Install WMF 5.1 from the Command Prompt","pos":[2983,3022]},{"content":"After downloading the correct package for your computer's architecture, open a Command Prompt window with elevated user rights (Run as Administrator).","pos":[3029,3179]},{"content":"On the Server Core installation options of Windows Server 2012 R2, Windows Server 2012, or Windows Server 2008 R2 SP1, Command Prompt opens with elevated user rights by default.","pos":[3180,3357]},{"content":"Change directories to the folder into which you have downloaded or copied the WMF 5.1 installation package.","pos":[3362,3469]},{"content":"Run one of the following commands:","pos":[3474,3508]},{"pos":[3515,3636],"content":"On computers that are running Windows Server 2012 R2 or Windows 8.1 x64, run <ph id=\"ph1\">`Win8.1AndW2K12R2-KB3156422-x64.msu /quiet`</ph>.","source":"On computers that are running Windows Server 2012 R2 or Windows 8.1 x64, run `Win8.1AndW2K12R2-KB3156422-x64.msu /quiet`."},{"pos":[3643,3731],"content":"On computers that are running Windows Server 2012, run <ph id=\"ph1\">`W2K12-KB3156423-x64.msu /quiet`</ph>.","source":"On computers that are running Windows Server 2012, run `W2K12-KB3156423-x64.msu /quiet`."},{"pos":[3738,3862],"content":"On computers that are running Windows Server 2008 R2 SP1 or Windows 7 SP1 x64, run <ph id=\"ph1\">`Win7AndW2K8R2-KB3156424-x64.msu /quiet`</ph>.","source":"On computers that are running Windows Server 2008 R2 SP1 or Windows 7 SP1 x64, run `Win7AndW2K8R2-KB3156424-x64.msu /quiet`."},{"pos":[3869,3954],"content":"On computers that are running Windows 8.1 x86, run <ph id=\"ph1\">`Win8.1-KB3156422-x86.msu /quiet`</ph>.","source":"On computers that are running Windows 8.1 x86, run `Win8.1-KB3156422-x86.msu /quiet`."},{"pos":[3961,4046],"content":"On computers that are running Windows 7 SP1 x86, run <ph id=\"ph1\">`Win7-KB3156424-x86.msu /quiet`</ph>.","source":"On computers that are running Windows 7 SP1 x86, run `Win7-KB3156424-x86.msu /quiet`."},{"content":"Additional Installation Notes for Windows Server 2008 SP1 and Windows 7 SP1","pos":[4051,4126]},{"content":"Installation of WMF 5.1 on either Windows Server 2008 SP1 or Windows 7 SP1, require the installation of:","pos":[4129,4233]},{"content":"Latest service pack.","pos":[4236,4256]},{"pos":[4259,4331],"content":"<bpt id=\"p1\">[</bpt>WMF 4.0<ept id=\"p1\">](http://www.microsoft.com/en-us/download/details.aspx?id=40855)</ept>","source":"[WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855)"},{"content":"WMF 5.1 requires <bpt id=\"p1\">[</bpt>Microsoft .NET Framework 4.6<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/3045560)</ept>.","pos":[4334,4430],"source":"WMF 5.1 requires [Microsoft .NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560)."},{"content":"You can install Microsoft .NET Framework 4.6 by following the instructions at the download location.","pos":[4431,4532],"source":" \nYou can install Microsoft .NET Framework 4.6 by following the instructions at the download location."},{"content":"Security update for <bpt id=\"p1\">[</bpt>SHA-2 Code Signing<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/security/3033929)</ept>.","pos":[4535,4638],"source":"Security update for [SHA-2 Code Signing](https://technet.microsoft.com/en-us/library/security/3033929)."},{"content":"This is needed to use new PowerShell cmdlets for Windows catalog files.","pos":[4639,4710]},{"content":"<bpt id=\"p1\">**</bpt>WinRM Dependency<ept id=\"p1\">**</ept> - Windows PowerShell Desired State Configuration (DSC) depends on WinRM.","pos":[4715,4808],"source":"**WinRM Dependency** - Windows PowerShell Desired State Configuration (DSC) depends on WinRM."},{"content":"WinRM is not enabled by default on Windows Server 2008 R2 and Windows 7.","pos":[4809,4881]},{"content":"Run <ph id=\"ph1\">`Set-WSManQuickConfig`</ph>, in a Windows PowerShell elevated session, to enable WinRM.","pos":[4882,4968],"source":" Run `Set-WSManQuickConfig`, in a Windows PowerShell elevated session, to enable WinRM."}],"content":"---\ntitle: Install and configure WMF 5.1 (Preview)\nms.date:  2016-05-16\nkeywords:  PowerShell, DSC, WMF\ndescription:  \nms.topic:  article\ncontributor:  kriscv\nmanager:  dongill\nms.prod:  powershell\nms.technology: WMF\n---\n\n# Install and Configure WMF 5.1 (Preview) #\n\n## Install .Net 4.6\nYou must install the .NET Framework 4.6 to use WMF 5.1. \nThis is required to enable the new catalog-signing features, which impacts several areas of module and script loading in WMF 5.1. \n\nThe [.NET Framework 4.6 is available as KB 3045560](https://support.microsoft.com/en-us/kb/3045560). \nInstall instructions are available at the download location.\n\n> **Note:** It is a known issue that .NET 4.6 requirement is not detected by the WMF 5.1 Preview installer, so you will be able to install WMF 5.1 Preview before installing .NET 4.6. \nOur testing has shown that you can install .NET 4.6 after installing the WMF 5.1 Preview. \nThe final version of WMF 5.1 will correctly check this prerequisite requirement before installing. \n\n## Download and install the WMF 5.1 Preview\n\nDownload the WMF 5.1 package for the operating system and architecture you wish to install it on:\n\n| Operating System       | Prerequisites | Package Links             |\n|------------------------|---------------|---------------------------|\n| Windows Server 2012 R2 | [.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560) | [Win8.1AndW2K12R2-KB3156422-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823586)|\n| Windows Server 2012    | [.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560) | [W2K12-KB3156423-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823587)|\n| Windows Server 2008 R2 | [.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560) </br> [WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855) </br> Security update for [SHA-2 Code Signing](https://technet.microsoft.com/en-us/library/security/3033929) | [Win7AndW2K8R2-KB3156424-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823588) |\n| Windows 8.1            | [.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560) | **x64:** [Win8.1AndW2K12R2-KB3156422-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823586) </br> **x86:** [Win8.1-KB3156422-x86.msu](http://go.microsoft.com/fwlink/?LinkID=823589) |\n| Windows 7 SP1          | [.NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560) </br> [WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855) </br> Security update for [SHA-2 Code Signing](https://technet.microsoft.com/en-us/library/security/3033929) | **x64:** [Win7AndW2K8R2-KB3156424-x64.msu](http://go.microsoft.com/fwlink/?LinkID=823588) </br> **x86:** [Win7-KB3156424-x86.msu](http://go.microsoft.com/fwlink/?LinkID=823590) |\n\n\n## Install WMF 5.1 from Windows Explorer (or File Explorer in Windows Server 2012 R2 or Windows 8.1)\n\n1. Navigate to the folder into which you downloaded the MSU file.\n\n2. Double-click the MSU to run it.\n\n## Install WMF 5.1 from the Command Prompt##\n\n1. After downloading the correct package for your computer's architecture, open a Command Prompt window with elevated user rights (Run as Administrator). On the Server Core installation options of Windows Server 2012 R2, Windows Server 2012, or Windows Server 2008 R2 SP1, Command Prompt opens with elevated user rights by default.\n\n2. Change directories to the folder into which you have downloaded or copied the WMF 5.1 installation package.\n\n3. Run one of the following commands:\n    - On computers that are running Windows Server 2012 R2 or Windows 8.1 x64, run `Win8.1AndW2K12R2-KB3156422-x64.msu /quiet`.\n    - On computers that are running Windows Server 2012, run `W2K12-KB3156423-x64.msu /quiet`.\n    - On computers that are running Windows Server 2008 R2 SP1 or Windows 7 SP1 x64, run `Win7AndW2K8R2-KB3156424-x64.msu /quiet`.\n    - On computers that are running Windows 8.1 x86, run `Win8.1-KB3156422-x86.msu /quiet`.\n    - On computers that are running Windows 7 SP1 x86, run `Win7-KB3156424-x86.msu /quiet`.\n\n## Additional Installation Notes for Windows Server 2008 SP1 and Windows 7 SP1##\nInstallation of WMF 5.1 on either Windows Server 2008 SP1 or Windows 7 SP1, require the installation of:\n- Latest service pack.\n- [WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855)\n- WMF 5.1 requires [Microsoft .NET Framework 4.6](https://support.microsoft.com/en-us/kb/3045560). \nYou can install Microsoft .NET Framework 4.6 by following the instructions at the download location.\n- Security update for [SHA-2 Code Signing](https://technet.microsoft.com/en-us/library/security/3033929). This is needed to use new PowerShell cmdlets for Windows catalog files. \n\n> **WinRM Dependency** - Windows PowerShell Desired State Configuration (DSC) depends on WinRM. WinRM is not enabled by default on Windows Server 2008 R2 and Windows 7. Run `Set-WSManQuickConfig`, in a Windows PowerShell elevated session, to enable WinRM.\n\n"}