{"nodes":[{"pos":[105,126],"content":"powershell,cmdlet,jea","needQuote":true,"nodes":[{"content":"powershell,cmdlet,jea","pos":[0,21]}]},{"pos":[156,165],"content":"using jea","needQuote":true,"nodes":[{"content":"using jea","pos":[0,9]}]},{"content":"Using JEA","pos":[200,209]},{"content":"This section focuses on understanding the end user experience of <bpt id=\"p1\">*</bpt>using JEA<ept id=\"p1\">*</ept>.","pos":[210,287],"source":"This section focuses on understanding the end user experience of *using JEA*."},{"content":"In the prerequisites section, you created a demo JEA endpoint.","pos":[288,350],"source":"\nIn the prerequisites section, you created a demo JEA endpoint."},{"content":"We will use this demo to show JEA in action.","pos":[351,395],"source":"\nWe will use this demo to show JEA in action."},{"content":"In later sections, the guide will work backwards -- introducing the actions and files that made that end-user experience possible.","pos":[396,526],"source":"\nIn later sections, the guide will work backwards -- introducing the actions and files that made that end-user experience possible."},{"content":"Using JEA as a Non-Administrator","pos":[531,563]},{"content":"To show JEA in action, you will need to use PowerShell remoting as though you were a non-administrator user.","pos":[564,672]},{"content":"Run the following command in a new PowerShell window:","pos":[673,726],"source":"\nRun the following command in a new PowerShell window:"},{"content":"Enter the credentials for your non-administrator account when prompted.","pos":[781,852]},{"content":"If you followed the <bpt id=\"p1\">[</bpt>Set Up Users and Groups<ept id=\"p1\">](creating-a-domain-controller.md#set-up-users-and-groups)</ept> section, they will be:","pos":[853,978],"source":"\nIf you followed the [Set Up Users and Groups](creating-a-domain-controller.md#set-up-users-and-groups) section, they will be:"},{"content":"Username = \"OperatorUser\"","pos":[983,1008]},{"content":"Password = \"pa$$w0rd\"","pos":[1013,1034]},{"content":"Next, run the following command to connect to the demo endpoint using the credentials you provided:","pos":[1036,1135]},{"content":"You have now entered an interactive remote PowerShell session on the local machine.","pos":[1242,1325]},{"content":"By using the \"Credential\" parameter, you have connected <bpt id=\"p1\">*</bpt>as though you were<ept id=\"p1\">*</ept> OperatorUser (or whichever account you used).","pos":[1326,1448],"source":"\nBy using the \"Credential\" parameter, you have connected *as though you were* OperatorUser (or whichever account you used)."},{"content":"The change in the prompt to <ph id=\"ph1\">`[localhost]: PS&gt;`</ph> indicates that you are operating against a remote session.","pos":[1449,1554],"source":"\nThe change in the prompt to `[localhost]: PS>` indicates that you are operating against a remote session."},{"content":"Run the following in your remote command prompt to show the commands available to you:","pos":[1558,1644]},{"content":"As you can tell, this is a very limited subset of the commands available in a normal PowerShell window (which can often include several thousand commands).","pos":[1677,1832]},{"content":"Specifically, it only shows the 8 default JEA commands (Clear-Host, Exit-PSSession, Get-Command, Get-FormatData, Get-Help, Measure-Object, Out-Default, Select-Object) and the two commands explicitly included in the maintenance Role Capability file.","pos":[1833,2081],"source":"\nSpecifically, it only shows the 8 default JEA commands (Clear-Host, Exit-PSSession, Get-Command, Get-FormatData, Get-Help, Measure-Object, Out-Default, Select-Object) and the two commands explicitly included in the maintenance Role Capability file."},{"content":"Next, let's take a look at the user context this session is operating under by invoking the custom function included in the maintenance Role Capability file:","pos":[2083,2240]},{"content":"The output of this function shows the \"ConnectedUser\" as well as the \"RunAsUser.\"","pos":[2274,2355]},{"content":"The connected user is the account that connected to the remote session (e.g. your account).","pos":[2356,2447],"source":"\nThe connected user is the account that connected to the remote session (e.g. your account)."},{"content":"The connected user does not need to have administrator privileges.","pos":[2448,2514],"source":"\nThe connected user does not need to have administrator privileges."},{"content":"The \"Run As\" account is the account actually performing the privileged actions.","pos":[2515,2594],"source":"\nThe \"Run As\" account is the account actually performing the privileged actions."},{"content":"By connecting as one user, and running as a privileged user, we allow non-privileged users to preform specific administrative tasks without giving them administrative rights.","pos":[2595,2769],"source":"\nBy connecting as one user, and running as a privileged user, we allow non-privileged users to preform specific administrative tasks without giving them administrative rights."},{"content":"To demonstrate this in action, run the following command:","pos":[2771,2828]},{"content":"Normally, Restart-Service requires administrator privileges to be run.","pos":[2888,2958]},{"content":"With the JEA virtual account, however, we're able to run it using non-privileged credentials.","pos":[2959,3052],"source":"\nWith the JEA virtual account, however, we're able to run it using non-privileged credentials."},{"content":"So, JEA lets you get your job done using the commands you already use.","pos":[3054,3124]},{"content":"But what about commands you <bpt id=\"p1\">*</bpt>shouldn't<ept id=\"p1\">*</ept> be allowed to use?","pos":[3125,3183],"source":"\nBut what about commands you *shouldn't* be allowed to use?"},{"content":"Try running a different command in the JEA session, like <ph id=\"ph1\">`Restart-Computer`</ph>, and notice that JEA prevents such commands from being executed.","pos":[3184,3324],"source":"\nTry running a different command in the JEA session, like `Restart-Computer`, and notice that JEA prevents such commands from being executed."},{"content":"Finally, to leave the constrained JEA endpoint, run the following command:","pos":[3756,3830]},{"content":"This disconnects you from the remote PowerShell session.","pos":[3866,3922]}],"content":"---\ndescription:  \nmanager:  dongill\nms.topic:  article\nauthor:  jpjofre\nms.prod:  powershell\nkeywords:  powershell,cmdlet,jea\nms.date:  2016-06-22\ntitle:  using jea\nms.technology:  powershell\n---\n\n# Using JEA\nThis section focuses on understanding the end user experience of *using JEA*.\nIn the prerequisites section, you created a demo JEA endpoint.\nWe will use this demo to show JEA in action.\nIn later sections, the guide will work backwards -- introducing the actions and files that made that end-user experience possible.\n\n## Using JEA as a Non-Administrator\nTo show JEA in action, you will need to use PowerShell remoting as though you were a non-administrator user.\nRun the following command in a new PowerShell window:   \n\n```PowerShell\n$NonAdminCred = Get-Credential\n```\n\nEnter the credentials for your non-administrator account when prompted.\nIf you followed the [Set Up Users and Groups](creating-a-domain-controller.md#set-up-users-and-groups) section, they will be:\n-   Username = \"OperatorUser\"\n-   Password = \"pa$$w0rd\"\n\nNext, run the following command to connect to the demo endpoint using the credentials you provided:\n\n```PowerShell\nEnter-PSSession -ComputerName . -ConfigurationName JEA_Demo -Credential $NonAdminCred\n```\n\nYou have now entered an interactive remote PowerShell session on the local machine.\nBy using the \"Credential\" parameter, you have connected *as though you were* OperatorUser (or whichever account you used).\nThe change in the prompt to `[localhost]: PS>` indicates that you are operating against a remote session.  \n\nRun the following in your remote command prompt to show the commands available to you:\n\n```PowerShell\nGet-Command\n```\n\nAs you can tell, this is a very limited subset of the commands available in a normal PowerShell window (which can often include several thousand commands).\nSpecifically, it only shows the 8 default JEA commands (Clear-Host, Exit-PSSession, Get-Command, Get-FormatData, Get-Help, Measure-Object, Out-Default, Select-Object) and the two commands explicitly included in the maintenance Role Capability file.\n\nNext, let's take a look at the user context this session is operating under by invoking the custom function included in the maintenance Role Capability file:\n\n```PowerShell\nGet-UserInfo\n```\n\nThe output of this function shows the \"ConnectedUser\" as well as the \"RunAsUser.\"\nThe connected user is the account that connected to the remote session (e.g. your account).\nThe connected user does not need to have administrator privileges.\nThe \"Run As\" account is the account actually performing the privileged actions.\nBy connecting as one user, and running as a privileged user, we allow non-privileged users to preform specific administrative tasks without giving them administrative rights.\n\nTo demonstrate this in action, run the following command:\n\n```PowerShell\nRestart-Service -Name Spooler -Verbose\n```\n\nNormally, Restart-Service requires administrator privileges to be run.\nWith the JEA virtual account, however, we're able to run it using non-privileged credentials.\n\nSo, JEA lets you get your job done using the commands you already use.\nBut what about commands you *shouldn't* be allowed to use?\nTry running a different command in the JEA session, like `Restart-Computer`, and notice that JEA prevents such commands from being executed.\n\n```PowerShell\n[localhost]: PS> Restart-Computer\nThe term 'Restart-Computer' is not recognized as the name of a cmdlet, function, script file, or\noperable program. Check the spelling of the name, or if a path was included, verify that the path\nis correct and try again.\n    + CategoryInfo          : ObjectNotFound: (Restart-Computer:String) [], CommandNotFoundException\n    + FullyQualifiedErrorId : CommandNotFoundException\n```\n\nFinally, to leave the constrained JEA endpoint, run the following command:\n\n```PowerShell\nExit-PSSession\n```\n\nThis disconnects you from the remote PowerShell session.\n\n"}