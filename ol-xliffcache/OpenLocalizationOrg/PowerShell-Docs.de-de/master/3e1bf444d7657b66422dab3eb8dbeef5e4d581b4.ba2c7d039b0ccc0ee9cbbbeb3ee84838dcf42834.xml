{"nodes":[{"pos":[12,56],"content":"Working With Files Folders and Registry Keys","needQuote":true,"nodes":[{"content":"Working With Files Folders and Registry Keys","pos":[0,44]}]},{"pos":[89,106],"content":"powershell,cmdlet","needQuote":true,"nodes":[{"content":"powershell,cmdlet","pos":[0,17]}]},{"content":"Working With Files, Folders and Registry Keys","pos":[254,299]},{"content":"Windows PowerShell uses the noun <bpt id=\"p1\">**</bpt>Item<ept id=\"p1\">**</ept> to refer to items found on a Windows PowerShell drive.","pos":[300,396],"source":"Windows PowerShell uses the noun **Item** to refer to items found on a Windows PowerShell drive."},{"content":"When dealing with the Windows PowerShell FileSystem provider, an <bpt id=\"p1\">**</bpt>Item<ept id=\"p1\">**</ept> might be a file, a folder, or the Windows PowerShell drive.","pos":[397,530],"source":" When dealing with the Windows PowerShell FileSystem provider, an **Item** might be a file, a folder, or the Windows PowerShell drive."},{"content":"Listing and working with these items is a critical basic task in most administrative settings, so we want to discuss these tasks in detail.","pos":[531,670]},{"content":"Enumerating Files, Folders, and Registry Keys (Get-ChildItem)","pos":[676,737]},{"pos":[738,940],"content":"Since getting a collection of items from a particular location is such a common task, the <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> cmdlet is designed specifically to return all items found within a container such as a folder.","source":"Since getting a collection of items from a particular location is such a common task, the **Get-ChildItem** cmdlet is designed specifically to return all items found within a container such as a folder."},{"content":"If you want to return all files and folders that are contained directly within the folder C:\\\\Windows, type:","pos":[942,1050]},{"pos":[1435,1580],"content":"The listing looks similar to what you would see when you enter the <bpt id=\"p1\">**</bpt>dir<ept id=\"p1\">**</ept> command in <bpt id=\"p2\">**</bpt>Cmd.exe<ept id=\"p2\">**</ept>, or the <bpt id=\"p3\">**</bpt>ls<ept id=\"p3\">**</ept> command in a UNIX command shell.","source":"The listing looks similar to what you would see when you enter the **dir** command in **Cmd.exe**, or the **ls** command in a UNIX command shell."},{"content":"You can perform very complex listings by using parameters of the <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> cmdlet.","pos":[1582,1672],"source":"You can perform very complex listings by using parameters of the **Get-ChildItem** cmdlet."},{"content":"We will look at a few scenarios next.","pos":[1673,1710]},{"content":"You can see the syntax the <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> cmdlet by typing:","pos":[1711,1773],"source":" You can see the syntax the **Get-ChildItem** cmdlet by typing:"},{"content":"These parameters can be mixed and matched to get highly customized output.","pos":[1828,1902]},{"content":"Listing all Contained Items (-Recurse)","pos":[1909,1947]},{"content":"To see both the items inside a Windows folder and any items that are contained within the subfolders, use the <bpt id=\"p1\">**</bpt>Recurse<ept id=\"p1\">**</ept> parameter of <bpt id=\"p2\">**</bpt>Get-ChildItem<ept id=\"p2\">**</ept>.","pos":[1948,2101],"source":"To see both the items inside a Windows folder and any items that are contained within the subfolders, use the **Recurse** parameter of **Get-ChildItem**."},{"content":"The listing displays everything within the Windows folder and the items in its subfolders.","pos":[2102,2192]},{"content":"For example:","pos":[2193,2205]},{"content":"Filtering Items by Name (-Name)","pos":[2581,2612]},{"pos":[2613,2697],"content":"To display only the names of items, use the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> parameter of <bpt id=\"p2\">**</bpt>Get-Childitem<ept id=\"p2\">**</ept>:","source":"To display only the names of items, use the **Name** parameter of **Get-Childitem**:"},{"content":"Forcibly Listing Hidden Items (-Force)","pos":[2783,2821]},{"content":"Items that are normally invisible in File Explorer or Cmd.exe are not displayed in the output of a <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> command.","pos":[2822,2947],"source":"Items that are normally invisible in File Explorer or Cmd.exe are not displayed in the output of a **Get-ChildItem** command."},{"content":"To display hidden items, use the <bpt id=\"p1\">**</bpt>Force<ept id=\"p1\">**</ept> parameter of <bpt id=\"p2\">**</bpt>Get-ChildItem<ept id=\"p2\">**</ept>.","pos":[2948,3022],"source":" To display hidden items, use the **Force** parameter of **Get-ChildItem**."},{"content":"For example:","pos":[3023,3035]},{"content":"This parameter is named Force because you can forcibly override the normal behavior of the <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> command.","pos":[3084,3201],"source":"This parameter is named Force because you can forcibly override the normal behavior of the **Get-ChildItem** command."},{"content":"Force is a widely used parameter that forces an action that a cmdlet would not normally perform, although it will not perform any action that compromises the security of the system.","pos":[3202,3383]},{"content":"Matching Item Names with Wildcards","pos":[3390,3424]},{"pos":[3425,3506],"content":"<bpt id=\"p1\">**</bpt>The Get-ChildItem<ept id=\"p1\">**</ept> command accepts wildcards in the path of the items to list.","source":"**The Get-ChildItem** command accepts wildcards in the path of the items to list."},{"content":"Because wildcard matching is handled by the Windows PowerShell engine, all cmdlets that accepts wildcards use the same notation and have the same matching behavior.","pos":[3508,3672]},{"content":"The Windows PowerShell wildcard notation includes:","pos":[3673,3723]},{"content":"Asterisk (\\*)matches zero or more occurrences of any character.","pos":[3729,3792]},{"content":"Question mark (?) matches exactly one character.","pos":[3798,3846]},{"content":"Left bracket (\\[) character and right bracket (]) character surround a set of characters to be matched.","pos":[3852,3955]},{"content":"Here are some examples of how wildcard specification works.","pos":[3957,4016]},{"pos":[4018,4160],"content":"To find all files in the Windows directory with the suffix <bpt id=\"p1\">**</bpt>.log<ept id=\"p1\">**</ept> and exactly five characters in the base name, enter the following command:","source":"To find all files in the Windows directory with the suffix **.log** and exactly five characters in the base name, enter the following command:"},{"pos":[4620,4702],"content":"To find all files that begin with the letter <bpt id=\"p1\">**</bpt>x<ept id=\"p1\">**</ept> in the Windows directory, type:","source":"To find all files that begin with the letter **x** in the Windows directory, type:"},{"pos":[4747,4809],"content":"To find all files whose names begin with <bpt id=\"p1\">**</bpt>x<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>z<ept id=\"p2\">**</ept>, type:","source":"To find all files whose names begin with **x** or **z**, type:"},{"content":"Excluding Items (-Exclude)","pos":[4862,4888]},{"content":"You can exclude specific items by using the <bpt id=\"p1\">**</bpt>Exclude<ept id=\"p1\">**</ept> parameter of Get-ChildItem.","pos":[4889,4972],"source":"You can exclude specific items by using the **Exclude** parameter of Get-ChildItem."},{"content":"This lets you perform complex filtering in a single statement.","pos":[4973,5035]},{"content":"For example, suppose you are trying to find the Windows Time Service DLL in the System32 folder, and all you can remember about the DLL name is that it begins with \"W\" and has \"32\" in it.","pos":[5037,5224]},{"content":"An expression like <bpt id=\"p1\">**</bpt>w\\&amp;#42;32\\&amp;#42;.dll<ept id=\"p1\">**</ept> will find all DLLs that satisfy the conditions, but it may also return the Windows 95 and 16-bit Windows compatibility DLLs that include \"95\" or \"16\" in their names.","pos":[5226,5434],"source":"An expression like **w\\&#42;32\\&#42;.dll** will find all DLLs that satisfy the conditions, but it may also return the Windows 95 and 16-bit Windows compatibility DLLs that include \"95\" or \"16\" in their names."},{"content":"You can omit files that have any of these numbers in their names by using the <bpt id=\"p1\">**</bpt>Exclude<ept id=\"p1\">**</ept> parameter with the pattern <bpt id=\"p2\">**</bpt>\\&amp;#42;\\[9516]\\&amp;#42;<ept id=\"p2\">**</ept>:","pos":[5435,5576],"source":" You can omit files that have any of these numbers in their names by using the **Exclude** parameter with the pattern **\\&#42;\\[9516]\\&#42;**:"},{"content":"PS&gt; Get-ChildItem -Path C:\\WINDOWS\\System32\\w<bpt id=\"p1\">*</bpt>32<ept id=\"p1\">*</ept>.dll -Exclude <bpt id=\"p2\">*</bpt>[9516]<ept id=\"p2\">*</ept> Directory: Microsoft.PowerShell.Core\\FileSystem::C:\\WINDOWS\\System32 Mode                LastWriteTime     Length Name ----                -------------     ------ ---- -a---        2004-08-04   8:00 AM     174592 w32time.dll -a---        2004-08-04   8:00 AM      22016 w32topl.dll -a---        2004-08-04   8:00 AM     101888 win32spl.dll -a---        2004-08-04   8:00 AM     172032 wldap32.dll -a---        2004-08-04   8:00 AM     264192 wow32.dll -a---        2004-08-04   8:00 AM      82944 ws2_32.dll -a---        2004-08-04   8:00 AM      42496 wsnmp32.dll -a---        2004-08-04   8:00 AM      22528 wsock32.dll -a---        2004-08-04   8:00 AM      18432 wtsapi32.dll","pos":[5583,6335],"source":"PS> Get-ChildItem -Path C:\\WINDOWS\\System32\\w*32*.dll -Exclude *[9516]*\nDirectory: Microsoft.PowerShell.Core\\FileSystem::C:\\WINDOWS\\System32\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        2004-08-04   8:00 AM     174592 w32time.dll\n-a---        2004-08-04   8:00 AM      22016 w32topl.dll\n-a---        2004-08-04   8:00 AM     101888 win32spl.dll\n-a---        2004-08-04   8:00 AM     172032 wldap32.dll\n-a---        2004-08-04   8:00 AM     264192 wow32.dll\n-a---        2004-08-04   8:00 AM      82944 ws2_32.dll\n-a---        2004-08-04   8:00 AM      42496 wsnmp32.dll\n-a---        2004-08-04   8:00 AM      22528 wsock32.dll\n-a---        2004-08-04   8:00 AM      18432 wtsapi32.dll"},{"content":"Mixing Get-ChildItem Parameters","pos":[6348,6379]},{"content":"You can use several of the parameters of the <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> cmdlet in the same command.","pos":[6380,6470],"source":"You can use several of the parameters of the **Get-ChildItem** cmdlet in the same command."},{"content":"Before you mix parameters, be sure that you understand wildcard matching.","pos":[6471,6544]},{"content":"For example, the following command returns no results:","pos":[6545,6599]},{"content":"There are no results, even though there are two DLLs that begin with the letter \"z\" in the Windows folder.","pos":[6680,6786]},{"content":"No results were returned because we specified the wildcard as part of the path.","pos":[6788,6867]},{"content":"Even though the command was recursive, the <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> cmdlet restricted the items to those that are in the Windows folder with names ending with \".dll\".","pos":[6868,7027],"source":" Even though the command was recursive, the **Get-ChildItem** cmdlet restricted the items to those that are in the Windows folder with names ending with \".dll\"."},{"pos":[7029,7137],"content":"To specify a recursive search for files whose names match a special pattern, use the <bpt id=\"p1\">**</bpt>-Include<ept id=\"p1\">**</ept> parameter.","source":"To specify a recursive search for files whose names match a special pattern, use the **-Include** parameter."}],"content":"---\ntitle:  Working With Files Folders and Registry Keys\nms.date:  2016-05-11\nkeywords:  powershell,cmdlet\ndescription:  \nms.topic:  article\nauthor:  jpjofre\nmanager:  dongill\nms.prod:  powershell\nms.assetid:  e6cf87aa-b5f8-48d5-a75a-7cb7ecb482dc\n---\n\n# Working With Files, Folders and Registry Keys\nWindows PowerShell uses the noun **Item** to refer to items found on a Windows PowerShell drive. When dealing with the Windows PowerShell FileSystem provider, an **Item** might be a file, a folder, or the Windows PowerShell drive. Listing and working with these items is a critical basic task in most administrative settings, so we want to discuss these tasks in detail.\n\n### Enumerating Files, Folders, and Registry Keys (Get-ChildItem)\nSince getting a collection of items from a particular location is such a common task, the **Get-ChildItem** cmdlet is designed specifically to return all items found within a container such as a folder.\n\nIf you want to return all files and folders that are contained directly within the folder C:\\\\Windows, type:\n\n```\nPS> Get-ChildItem -Path C:\\Windows\n    Directory: Microsoft.Windows PowerShell.Core\\FileSystem::C:\\Windows\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        2006-05-16   8:10 AM          0 0.log\n-a---        2005-11-29   3:16 PM         97 acc1.txt\n-a---        2005-10-23  11:21 PM       3848 actsetup.log\n...\n```\n\nThe listing looks similar to what you would see when you enter the **dir** command in **Cmd.exe**, or the **ls** command in a UNIX command shell.\n\nYou can perform very complex listings by using parameters of the **Get-ChildItem** cmdlet. We will look at a few scenarios next. You can see the syntax the **Get-ChildItem** cmdlet by typing:\n\n```\nPS> Get-Command -Name Get-ChildItem -Syntax\n```\n\nThese parameters can be mixed and matched to get highly customized output.\n\n#### Listing all Contained Items (-Recurse)\nTo see both the items inside a Windows folder and any items that are contained within the subfolders, use the **Recurse** parameter of **Get-ChildItem**. The listing displays everything within the Windows folder and the items in its subfolders. For example:\n\n```\nPS> Get-ChildItem -Path C:\\WINDOWS -Recurse\n\n    Directory: Microsoft.Windows PowerShell.Core\\FileSystem::C:\\WINDOWS\n    Directory: Microsoft.Windows PowerShell.Core\\FileSystem::C:\\WINDOWS\\AppPatch\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        2004-08-04   8:00 AM    1852416 AcGenral.dll\n...\n```\n\n#### Filtering Items by Name (-Name)\nTo display only the names of items, use the **Name** parameter of **Get-Childitem**:\n\n```\nPS> Get-ChildItem -Path C:\\WINDOWS -Name\naddins\nAppPatch\nassembly\n...\n```\n\n#### Forcibly Listing Hidden Items (-Force)\nItems that are normally invisible in File Explorer or Cmd.exe are not displayed in the output of a **Get-ChildItem** command. To display hidden items, use the **Force** parameter of **Get-ChildItem**. For example:\n\n```\nGet-ChildItem -Path C:\\Windows -Force\n```\n\nThis parameter is named Force because you can forcibly override the normal behavior of the **Get-ChildItem** command. Force is a widely used parameter that forces an action that a cmdlet would not normally perform, although it will not perform any action that compromises the security of the system.\n\n#### Matching Item Names with Wildcards\n**The Get-ChildItem** command accepts wildcards in the path of the items to list.\n\nBecause wildcard matching is handled by the Windows PowerShell engine, all cmdlets that accepts wildcards use the same notation and have the same matching behavior. The Windows PowerShell wildcard notation includes:\n\n-   Asterisk (\\*)matches zero or more occurrences of any character.\n\n-   Question mark (?) matches exactly one character.\n\n-   Left bracket (\\[) character and right bracket (]) character surround a set of characters to be matched.\n\nHere are some examples of how wildcard specification works.\n\nTo find all files in the Windows directory with the suffix **.log** and exactly five characters in the base name, enter the following command:\n\n```\nPS> Get-ChildItem -Path C:\\Windows\\?????.log\n    Directory: Microsoft.Windows PowerShell.Core\\FileSystem::C:\\Windows\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n...\n-a---        2006-05-11   6:31 PM     204276 ocgen.log\n-a---        2006-05-11   6:31 PM      22365 ocmsn.log\n...\n-a---        2005-11-11   4:55 AM         64 setup.log\n-a---        2005-12-15   2:24 PM      17719 VxSDM.log\n...\n```\n\nTo find all files that begin with the letter **x** in the Windows directory, type:\n\n```\nGet-ChildItem -Path C:\\Windows\\x*\n```\n\nTo find all files whose names begin with **x** or **z**, type:\n\n```\nGet-ChildItem -Path C:\\Windows\\[xz]*\n```\n\n#### Excluding Items (-Exclude)\nYou can exclude specific items by using the **Exclude** parameter of Get-ChildItem. This lets you perform complex filtering in a single statement.\n\nFor example, suppose you are trying to find the Windows Time Service DLL in the System32 folder, and all you can remember about the DLL name is that it begins with \"W\" and has \"32\" in it.\n\nAn expression like **w\\&#42;32\\&#42;.dll** will find all DLLs that satisfy the conditions, but it may also return the Windows 95 and 16-bit Windows compatibility DLLs that include \"95\" or \"16\" in their names. You can omit files that have any of these numbers in their names by using the **Exclude** parameter with the pattern **\\&#42;\\[9516]\\&#42;**:\n\n<pre>PS> Get-ChildItem -Path C:\\WINDOWS\\System32\\w*32*.dll -Exclude *[9516]*\nDirectory: Microsoft.PowerShell.Core\\FileSystem::C:\\WINDOWS\\System32\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        2004-08-04   8:00 AM     174592 w32time.dll\n-a---        2004-08-04   8:00 AM      22016 w32topl.dll\n-a---        2004-08-04   8:00 AM     101888 win32spl.dll\n-a---        2004-08-04   8:00 AM     172032 wldap32.dll\n-a---        2004-08-04   8:00 AM     264192 wow32.dll\n-a---        2004-08-04   8:00 AM      82944 ws2_32.dll\n-a---        2004-08-04   8:00 AM      42496 wsnmp32.dll\n-a---        2004-08-04   8:00 AM      22528 wsock32.dll\n-a---        2004-08-04   8:00 AM      18432 wtsapi32.dll</pre>\n\n#### Mixing Get-ChildItem Parameters\nYou can use several of the parameters of the **Get-ChildItem** cmdlet in the same command. Before you mix parameters, be sure that you understand wildcard matching. For example, the following command returns no results:\n\n```\nPS> Get-ChildItem -Path C:\\Windows\\*.dll -Recurse -Exclude [a-y]*.dll\n```\n\nThere are no results, even though there are two DLLs that begin with the letter \"z\" in the Windows folder.\n\nNo results were returned because we specified the wildcard as part of the path. Even though the command was recursive, the **Get-ChildItem** cmdlet restricted the items to those that are in the Windows folder with names ending with \".dll\".\n\nTo specify a recursive search for files whose names match a special pattern, use the **-Include** parameter.\n\n```\nPS> Get-ChildItem -Path C:\\Windows -Include *.dll -Recurse -Exclude [a-y]*.dll\n\n    Directory: Microsoft.Windows PowerShell.Core\\FileSystem::C:\\Windows\\System32\\Setup\n\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        2004-08-04   8:00 AM       8261 zoneoc.dll\n\n    Directory: Microsoft.Windows PowerShell.Core\\FileSystem::C:\\Windows\\System32\n\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        2004-08-04   8:00 AM     337920 zipfldr.dll\n```\n\n"}