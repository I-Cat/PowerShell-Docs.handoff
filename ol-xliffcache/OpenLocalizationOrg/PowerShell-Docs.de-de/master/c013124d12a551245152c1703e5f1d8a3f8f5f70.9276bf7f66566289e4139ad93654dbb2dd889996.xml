{"nodes":[{"pos":[12,33],"content":"Working with Printers","needQuote":true,"nodes":[{"content":"Working with Printers","pos":[0,21]}]},{"pos":[66,83],"content":"powershell,cmdlet","needQuote":true,"nodes":[{"content":"powershell,cmdlet","pos":[0,17]}]},{"content":"Working with Printers","pos":[231,252]},{"content":"You can use Windows PowerShell to manage printers by using WMI and the WScript.Network COM object from WSH.","pos":[253,360]},{"content":"We will use a mix of both tools to demonstrate specific tasks.","pos":[361,423]},{"content":"Listing Printer Connections","pos":[429,456]},{"pos":[457,561],"content":"The simplest way to list the printers installed on a computer is to use the WMI <bpt id=\"p1\">**</bpt>Win32_Printer<ept id=\"p1\">**</ept> class:","source":"The simplest way to list the printers installed on a computer is to use the WMI **Win32_Printer** class:"},{"pos":[621,734],"content":"You can also list the printers by using the <bpt id=\"p1\">**</bpt>WScript.Network<ept id=\"p1\">**</ept> COM object that is typically used in WSH scripts:","source":"You can also list the printers by using the **WScript.Network** COM object that is typically used in WSH scripts:"},{"content":"Because this command returns a simple string collection of port names and printer device names without any distinguishing labels, it is not easy to interpret.","pos":[810,968]},{"content":"Adding a Network Printer","pos":[974,998]},{"pos":[999,1053],"content":"To add a new network printer, use <bpt id=\"p1\">**</bpt>WScript.Network<ept id=\"p1\">**</ept>:","source":"To add a new network printer, use **WScript.Network**:"},{"content":"Setting a Default Printer","pos":[1162,1187]},{"pos":[1188,1329],"content":"To use WMI to set the default printer, find the printer in the <bpt id=\"p1\">**</bpt>Win32_Printer<ept id=\"p1\">**</ept> collection and then invoke the <bpt id=\"p2\">**</bpt>SetDefaultPrinter<ept id=\"p2\">**</ept> method:","source":"To use WMI to set the default printer, find the printer in the **Win32_Printer** collection and then invoke the **SetDefaultPrinter** method:"},{"pos":[1446,1588],"content":"<bpt id=\"p1\">**</bpt>WScript.Network<ept id=\"p1\">**</ept> is a little simpler to use, because it has a <bpt id=\"p2\">**</bpt>SetDefaultPrinter<ept id=\"p2\">**</ept> method that takes only the printer name as an argument:","source":"**WScript.Network** is a little simpler to use, because it has a **SetDefaultPrinter** method that takes only the printer name as an argument:"},{"content":"Removing a Printer Connection","pos":[1680,1709]},{"pos":[1710,1801],"content":"To remove a printer connection, use the <bpt id=\"p1\">**</bpt>WScript.Network RemovePrinterConnection<ept id=\"p1\">**</ept> method:","source":"To remove a printer connection, use the **WScript.Network RemovePrinterConnection** method:"}],"content":"---\ntitle:  Working with Printers\nms.date:  2016-05-11\nkeywords:  powershell,cmdlet\ndescription:  \nms.topic:  article\nauthor:  jpjofre\nmanager:  dongill\nms.prod:  powershell\nms.assetid:  4f29ead3-f83b-4706-ac3e-f2154ff38dc5\n---\n\n# Working with Printers\nYou can use Windows PowerShell to manage printers by using WMI and the WScript.Network COM object from WSH. We will use a mix of both tools to demonstrate specific tasks.\n\n### Listing Printer Connections\nThe simplest way to list the printers installed on a computer is to use the WMI **Win32_Printer** class:\n\n```\nGet-WmiObject -Class Win32_Printer -ComputerName\n```\n\nYou can also list the printers by using the **WScript.Network** COM object that is typically used in WSH scripts:\n\n```\n(New-Object -ComObject WScript.Network).EnumPrinterConnections()\n```\n\nBecause this command returns a simple string collection of port names and printer device names without any distinguishing labels, it is not easy to interpret.\n\n### Adding a Network Printer\nTo add a new network printer, use **WScript.Network**:\n\n```\n(New-Object -ComObject WScript.Network).AddWindowsPrinterConnection(\"\\\\Printserver01\\Xerox5\")\n```\n\n### Setting a Default Printer\nTo use WMI to set the default printer, find the printer in the **Win32_Printer** collection and then invoke the **SetDefaultPrinter** method:\n\n```\n(Get-WmiObject -ComputerName . -Class Win32_Printer -Filter \"Name='HP LaserJet 5Si'\").SetDefaultPrinter()\n```\n\n**WScript.Network** is a little simpler to use, because it has a **SetDefaultPrinter** method that takes only the printer name as an argument:\n\n```\n(New-Object -ComObject WScript.Network).SetDefaultPrinter('HP LaserJet 5Si')\n```\n\n### Removing a Printer Connection\nTo remove a printer connection, use the **WScript.Network RemovePrinterConnection** method:\n\n```\n(New-Object -ComObject WScript.Network).RemovePrinterConnection(\"\\\\Printserver01\\Xerox5\")\n```\n\n"}