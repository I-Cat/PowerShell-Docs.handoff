{"nodes":[{"content":"Installation of Module Dependencies","pos":[2,37]},{"content":"There is now side-by-side (SxS) module version support in Install-Module, Update-Module, and Publish-Module cmdlets that run in Windows PowerShell 5.0 or newer.","pos":[39,199]},{"content":"Also, we have added a -RequiredVersion parameter to the Publish-Module cmdlet to specify the version to be published.","pos":[200,317],"source":"\nAlso, we have added a -RequiredVersion parameter to the Publish-Module cmdlet to specify the version to be published."},{"content":"The Path parameter now supports the module base path with the version folder.","pos":[318,395]},{"pos":[397,425],"content":"<bpt id=\"p1\">**</bpt>Install-Module examples:<ept id=\"p1\">**</ept>","source":"**Install-Module examples:**"},{"pos":[1454,1493],"content":"<bpt id=\"p1\">**</bpt>Install a module with dependencies:<ept id=\"p1\">**</ept>","source":"**Install a module with dependencies:**"},{"pos":[3933,3994],"content":"<bpt id=\"p1\">**</bpt>Contents of ModuleWithDependencies2 module manifest file:<ept id=\"p1\">**</ept>","source":"**Contents of ModuleWithDependencies2 module manifest file:**"},{"pos":[6362,6389],"content":"<bpt id=\"p1\">**</bpt>Update-Module examples:<ept id=\"p1\">**</ept>","source":"**Update-Module examples:**"},{"pos":[8185,8213],"content":"<bpt id=\"p1\">**</bpt>Publish-Module examples:<ept id=\"p1\">**</ept>","source":"**Publish-Module examples:**"}],"content":"# Installation of Module Dependencies\n\nThere is now side-by-side (SxS) module version support in Install-Module, Update-Module, and Publish-Module cmdlets that run in Windows PowerShell 5.0 or newer.\nAlso, we have added a -RequiredVersion parameter to the Publish-Module cmdlet to specify the version to be published. The Path parameter now supports the module base path with the version folder.\n\n**Install-Module examples:**\n```powershell\nPS C:\\\\windows\\\\system32&gt; Install-Module -Name ContosoServer -RequiredVersion 1.0 -Repository MSPSGallery\nPS C:\\\\windows\\\\system32&gt; Get-Module -ListAvailable -Name ContosoServer | Format-List Name,Version,ModuleBase\nName : ContosoServer\nVersion : 1.0\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\1.0\nPS C:\\\\windows\\\\system32&gt; Install-Module -Name ContosoServer -RequiredVersion 2.0 -Repository MSPSGallery\nPS C:\\\\windows\\\\system32&gt; Get-Module -ListAvailable -Name ContosoServer | Format-List Name,Version,ModuleBase\nName : ContosoServer\nVersion : 2.0\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\2.0\nName : ContosoServer\nVersion : 1.0\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\1.0\nPS C:\\\\windows\\\\system32&gt; Get-InstalledModule\nVersion Name Repository Description\n------- ---- ---------- -----------\n1.0 ContosoServer MSPSGallery ContosoServer module\n2.0 ContosoServer MSPSGallery ContosoServer module\n```\n\n**Install a module with dependencies:**\n```powershell\nPS C:\\\\windows\\\\system32&gt; Get-InstalledModule\nPS C:\\\\windows\\\\system32&gt; Find-Module -Repository GalleryINT -Name ModuleWithDependencies2 -IncludeDependencies\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.0 ModuleWithDependencies2 Module GalleryINT ModuleWithDependencies2 module\n2.5 RequiredModule1 Module GalleryINT RequiredModule1 module\n2.5 RequiredModule2 Module GalleryINT RequiredModule2 module\n2.5 RequiredModule3 Module GalleryINT RequiredModule3 module\n2.0 RequiredModule4 Module GalleryINT RequiredModule4 module\n1.5 RequiredModule5 Module GalleryINT RequiredModule5 module\n2.5 NestedRequiredModule1 Module GalleryINT NestedRequiredModule1 module\n2.5 NestedRequiredModule2 Module GalleryINT NestedRequiredModule2 module\n2.5 NestedRequiredModule3 Module GalleryINT NestedRequiredModule3 module\n2.0 NestedRequiredModule4 Module GalleryINT NestedRequiredModule4 module\n1.5 NestedRequiredModule5 Module GalleryINT NestedRequiredModule5 module\n\nPS C:\\\\windows\\\\system32&gt; Install-Module -Repository GalleryINT -Name ModuleWithDependencies2 -Scope CurrentUser\nPS C:\\\\windows\\\\system32&gt; Get-InstalledModule\nVersion Name Type Repository Description\n------- ---- ---- ---------- -----------\n2.0 ModuleWithDependencies2 Module GalleryINT ModuleWithDependencies2 module\n2.5 NestedRequiredModule1 Module GalleryINT NestedRequiredModule1 module\n2.5 NestedRequiredModule2 Module GalleryINT NestedRequiredModule2 module\n2.5 NestedRequiredModule3 Module GalleryINT NestedRequiredModule3 module\n2.0 NestedRequiredModule4 Module GalleryINT NestedRequiredModule4 module\n1.5 NestedRequiredModule5 Module GalleryINT NestedRequiredModule5 module\n2.5 RequiredModule1 Module GalleryINT RequiredModule1 module\n2.5 RequiredModule2 Module GalleryINT RequiredModule2 module\n2.5 RequiredModule3 Module GalleryINT RequiredModule3 module\n2.0 RequiredModule4 Module GalleryINT RequiredModule4 module\n1.5 RequiredModule5 Module GalleryINT RequiredModule5 module\n\nPS C:\\\\windows\\\\system32&gt; $module = Get-Module -Name ModuleWithDependencies2 -ListAvailable\nPS C:\\\\windows\\\\system32&gt; $module\nDirectory: C:\\\\Users\\\\manikb\\\\Documents\\\\WindowsPowerShell\\\\Modules\nModuleType Version Name ExportedCommands\n---------- ------- ---- ----------------\nManifest 2.0 ModuleWithDependencies2 {Get-NestedRequiredModule1, Get-NestedRequiredModule2, Get-NestedRequiredModule3, Get-NestedRequiredModule4...}\n```\n\n**Contents of ModuleWithDependencies2 module manifest file:**\n```powershell\n@{\n\\# Version number of this module.\nModuleVersion = '2.0'\n\\# ID used to uniquely identify this module\nGUID = '0eae34da-99dd-4608-8d28-c614fe7b0841'\n\\# Author of this module\nAuthor = 'manikb'\n\\# Company or vendor of this module\nCompanyName = 'Unknown'\n\\# Copyright statement for this module\nCopyright = '(c) 2015 manikb. All rights reserved.'\n\\# Description of the functionality provided by this module\nDescription = 'ModuleWithDependencies2 module'\n\\# Modules that must be imported into the global environment prior to importing this module\nRequiredModules = @('RequiredModule1',\n@{ModuleName = 'RequiredModule2'; ModuleVersion = '2.0'; },\n@{ModuleName = 'RequiredModule3'; RequiredVersion = '2.5'; },\n@{ModuleName = 'RequiredModule4'; ModuleVersion = '1.1'; MaximumVersion = '2.0'; },\n@{ModuleName = 'RequiredModule5'; MaximumVersion = '1.5'; })\n\\# Modules to import as nested modules of the module specified in RootModule/ModuleToProcess\nNestedModules = @('NestedRequiredModule1',\n@{ModuleName = 'NestedRequiredModule2'; ModuleVersion = '2.0'; },\n@{ModuleName = 'NestedRequiredModule3'; RequiredVersion = '2.5'; },\n@{ModuleName = 'NestedRequiredModule4'; ModuleVersion = '0.7'; MaximumVersion = '2.4'; },\n@{ModuleName = 'NestedRequiredModule5'; MaximumVersion = '1.6'; },'ModuleWithDependencies2.psm1')\n\\# Functions to export from this module\nFunctionsToExport = '\\*'\n\\# Cmdlets to export from this module\nCmdletsToExport = '\\*'\n\\# Variables to export from this module\nVariablesToExport = '\\*'\n\\# Aliases to export from this module\nAliasesToExport = '\\*'\n\\# Private data to pass to the module specified in RootModule/ModuleToProcess. This may also contain a PSData hashtable with additional module metadata used by PowerShell.\nPrivateData = @{\nPSData = @{\n\\# Tags applied to this module. These help with module discovery in online galleries.\nTags = 'Tag1', 'Tag2', 'Tag-ModuleWithDependencies2-2.0'\n\\# A URL to the license for this module.\nLicenseUri = 'http://modulewithdependencies2.com/license'\n\\# A URL to the main website for this project.\nProjectUri = 'http://modulewithdependencies2.com/'\n\\# A URL to an icon representing this module.\nIconUri = 'http://modulewithdependencies2.com/icon'\n\\# ReleaseNotes of this module\nReleaseNotes = 'ModuleWithDependencies2 release notes'\n} \\# End of PSData hashtable\n} \\# End of PrivateData hashtable\n}\n```\n\n**Update-Module examples:**\n```powershell\nPS C:\\\\windows\\\\system32&gt; Update-Module -Name ContosoServer -RequiredVersion 1.5\nPS C:\\\\windows\\\\system32&gt; Get-Module -ListAvailable -Name ContosoServer | Format-List Name,Version,ModuleBase\nName : ContosoServer\nVersion : 2.0\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\2.0\nName : ContosoServer\nVersion : 1.5\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\1.5\nName : ContosoServer\nVersion : 1.0\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\1.0\nPS C:\\\\windows\\\\system32&gt; Get-InstalledModule\nVersion Name Repository Description\n------- ---- ---------- -----------\n1.0 ContosoServer MSPSGallery ContosoServer module\n1.5 ContosoServer MSPSGallery ContosoServer module\n2.0 ContosoServer MSPSGallery ContosoServer module\nPS C:\\\\windows\\\\system32&gt; Update-Module -Name ContosoServer\nPS C:\\\\windows\\\\system32&gt; Get-Module -ListAvailable -Name ContosoServer | Format-List Name,Version,ModuleBase\nName : ContosoServer\nVersion : 2.8.1\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\2.8.1\nName : ContosoServer\nVersion : 2.0\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\2.0\nName : ContosoServer\nVersion : 1.5\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\1.5\nName : ContosoServer\nVersion : 1.0\nModuleBase : C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\1.0\nPS C:\\\\windows\\\\system32&gt; Get-InstalledModule\nVersion Name Repository Description\n------- ---- ---------- -----------\n1.0 ContosoServer MSPSGallery ContosoServer module\n1.5 ContosoServer MSPSGallery ContosoServer module\n2.0 ContosoServer MSPSGallery ContosoServer module\n2.8.1 ContosoServer MSPSGallery ContosoServer module\n```\n\n**Publish-Module examples:**\n```powershell\nContosoServer module with different versions to be published.\nPS C:\\\\windows\\\\system32&gt; Get-Module -Name ContosoServer -ListAvailable\nDirectory: C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\nModuleType Version Name ExportedCommands\n---------- ------- ---- ----------------\nManifest 2.8 ContosoServer Get-ContosoServer\nManifest 2.0 ContosoServer Get-ContosoServer\nManifest 1.5 ContosoServer Get-ContosoServer\nManifest 1.0 ContosoServer Get-ContosoServer\nPS C:\\\\windows\\\\system32&gt; Publish-Module -Name ContosoServer -RequiredVersion 1.0 -Repository LocalRepo -NuGetApiKey Local-Repo-NuGet-ApiKey\nPS C:\\\\windows\\\\system32&gt; Find-Module -Name ContosoServer -Repository LocalRepo\nVersion Name Repository Description\n------- ---- ---------- -----------\n1.0 ContosoServer LocalRepo ContosoServer module\nPS C:\\\\windows\\\\system32&gt; Publish-Module -Name ContosoServer -RequiredVersion 1.5 -Repository LocalRepo -NuGetApiKey Local-Repo-NuGet-ApiKey\nPS C:\\\\windows\\\\system32&gt; Find-Module -Name ContosoServer -Repository LocalRepo\nVersion Name Repository Description\n------- ---- ---------- -----------\n1.0 ContosoServer LocalRepo ContosoServer module\n1.5 ContosoServer LocalRepo ContosoServer module\nPS C:\\\\windows\\\\system32&gt; Publish-Module -Path \"C:\\\\Program Files\\\\WindowsPowerShell\\\\Modules\\\\ContosoServer\\\\2.0\" -Repository LocalRepo -NuGetApiKey Local-Repo-NuGet-ApiKey\nPS C:\\\\windows\\\\system32&gt; Find-Module -Name ContosoServer -Repository LocalRepo\nVersion Name Repository Description\n_------ ---- ---------- -----------\n1.0 ContosoServer LocalRepo ContosoServer module\n1.5 ContosoServer LocalRepo ContosoServer module\n2.0 ContosoServer LocalRepo ContosoServer module\n```"}