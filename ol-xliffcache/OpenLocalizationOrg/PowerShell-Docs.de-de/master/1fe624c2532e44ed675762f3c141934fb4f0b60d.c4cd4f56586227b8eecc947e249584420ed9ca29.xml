{"nodes":[{"pos":[13,50],"content":"Calling DSC resource methods directly","needQuote":true,"nodes":[{"content":"Calling DSC resource methods directly","pos":[0,37]}]},{"pos":[83,97],"content":"powershell,DSC","needQuote":true,"nodes":[{"content":"powershell,DSC","pos":[0,14]}]},{"content":"Calling DSC resource methods directly","pos":[195,232]},{"content":"Applies To: Windows PowerShell 5.0","pos":[235,269]},{"content":"You can use the <bpt id=\"p1\">[</bpt>Invoke-DscResource<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/mt517869.aspx)</ept> cmdlet to directly call the functions or methods of a DSC resource (The <bpt id=\"p2\">**</bpt>Get-TargetResource<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Set-TargetResource<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Test-TargetResource<ept id=\"p4\">**</ept> functions of a MOF-based resource, or the <bpt id=\"p5\">**</bpt>Get<ept id=\"p5\">**</ept>, <bpt id=\"p6\">**</bpt>Set<ept id=\"p6\">**</ept>, and <bpt id=\"p7\">**</bpt>Test<ept id=\"p7\">**</ept> methods of a class-based resource).","pos":[271,623],"source":"You can use the [Invoke-DscResource](https://technet.microsoft.com/en-us/library/mt517869.aspx) cmdlet to directly call the functions or methods of a DSC resource (The **Get-TargetResource**,\n**Set-TargetResource**, and **Test-TargetResource** functions of a MOF-based resource, or the **Get**, **Set**, and **Test** methods of a class-based resource)."},{"content":"This can be used by third-parties that want to use DSC resources, or as a helpful tool while developing resources.","pos":[624,739],"source":" \nThis can be used by third-parties that want to use DSC resources, or as a helpful tool while developing resources."},{"pos":[742,909],"content":"This cmdlet is typically used in combination with a metaconfiguration property <ph id=\"ph1\">`refreshMode = 'Disabled'`</ph>, but it can be used no matter what <bpt id=\"p1\">**</bpt>refreshMode<ept id=\"p1\">**</ept> is set to.","source":"This cmdlet is typically used in combination with a metaconfiguration property `refreshMode = 'Disabled'`, but it can be used no matter what **refreshMode** is set to."},{"content":"When calling the <bpt id=\"p1\">**</bpt>Invoke-DscResource<ept id=\"p1\">**</ept> cmdlet, you specify which method or function to call by using the <bpt id=\"p2\">**</bpt>Method<ept id=\"p2\">**</ept> parameter.","pos":[911,1038],"source":"When calling the **Invoke-DscResource** cmdlet, you specify which method or function to call by using the **Method** parameter."},{"content":"You specify the properties of the resource by passing a hashtable as the value of the <bpt id=\"p1\">**</bpt>Property<ept id=\"p1\">**</ept> parameter.","pos":[1039,1149],"source":" You specify the properties of the resource by passing a \nhashtable as the value of the **Property** parameter."},{"content":"The following are examples of directly calling resource methods:","pos":[1151,1215]},{"content":"Ensure a file is present","pos":[1220,1244]},{"content":"Test that a file is present","pos":[1523,1550]},{"content":"Get the contents of file","pos":[1826,1850]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Directly calling composite resource methods is not supported.","pos":[2133,2204],"source":"**Note:** Directly calling composite resource methods is not supported."},{"content":"Instead, call the methods of the underlying resources that make up the composite resource.","pos":[2205,2295]},{"content":"See Also","pos":[2300,2308]},{"pos":[2311,2376],"content":"<bpt id=\"p1\">[</bpt>Writing a custom DSC resource with MOF<ept id=\"p1\">](authoringResourceMOF.md)</ept>","source":"[Writing a custom DSC resource with MOF](authoringResourceMOF.md)"},{"pos":[2380,2462],"content":"<bpt id=\"p1\">[</bpt>Writing a custom DSC resource with PowerShell classes<ept id=\"p1\">](authoringResourceClass.md)</ept>","source":"[Writing a custom DSC resource with PowerShell classes](authoringResourceClass.md)"},{"pos":[2465,2508],"content":"<bpt id=\"p1\">[</bpt>Debugging DSC resources<ept id=\"p1\">](debugResource.md)</ept>","source":"[Debugging DSC resources](debugResource.md)"}],"content":"---\ntitle:   Calling DSC resource methods directly\nms.date:  2016-05-16\nkeywords:  powershell,DSC\ndescription:  \nms.topic:  article\nauthor:  eslesar\nmanager:  dongill\nms.prod:  powershell\n---\n\n# Calling DSC resource methods directly\n\n>Applies To: Windows PowerShell 5.0\n\nYou can use the [Invoke-DscResource](https://technet.microsoft.com/en-us/library/mt517869.aspx) cmdlet to directly call the functions or methods of a DSC resource (The **Get-TargetResource**,\n**Set-TargetResource**, and **Test-TargetResource** functions of a MOF-based resource, or the **Get**, **Set**, and **Test** methods of a class-based resource). \nThis can be used by third-parties that want to use DSC resources, or as a helpful tool while developing resources. \n\nThis cmdlet is typically used in combination with a metaconfiguration property `refreshMode = 'Disabled'`, but it can be used no matter what **refreshMode** is set to.\n\nWhen calling the **Invoke-DscResource** cmdlet, you specify which method or function to call by using the **Method** parameter. You specify the properties of the resource by passing a \nhashtable as the value of the **Property** parameter.\n\nThe following are examples of directly calling resource methods:\n\n## Ensure a file is present\n\n```powershell\n$result = Invoke-DscResource -Name File -Method Set -Property @{\n                            DestinationPath = \"$env:SystemDrive\\\\DirectAccess.txt\";\n                            Contents = 'This file is create by Invoke-DscResource'} -Verbose\n$result | fl\n```\n\n## Test that a file is present\n\n```powershell\n$result = Invoke-DscResource -Name File -Method Test -Property @{\n                            DestinationPath=\"$env:SystemDrive\\\\DirectAccess.txt\";\n                            Contents='This file is create by Invoke-DscResource'} -Verbose\n$result | fl\n```\n\n## Get the contents of file\n\n```powershell\n$result = Invoke-DscResource -Name File -Method Get -Property @{\n                            DestinationPath=\"$env:SystemDrive\\\\DirectAccess.txt\";\n                            Contents='This file is create by Invoke-DscResource'} -Verbose\n$result.ItemValue | fl\n```\n\n>**Note:** Directly calling composite resource methods is not supported. Instead, call the methods of the underlying resources that make up the composite resource.\n\n## See Also\n- [Writing a custom DSC resource with MOF](authoringResourceMOF.md) \n- [Writing a custom DSC resource with PowerShell classes](authoringResourceClass.md)\n- [Debugging DSC resources](debugResource.md)\n\n"}